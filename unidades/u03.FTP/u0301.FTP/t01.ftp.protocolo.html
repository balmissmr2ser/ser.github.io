<!DOCTYPE html><html><head>
      <title>SER</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex.min.css">
      
      
      
      
      
      <style>
      @import url(https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css);
code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}@font-face{font-family:"Material Icons";font-style:normal;font-weight:400;src:local("Material Icons"),local("MaterialIcons-Regular"),url("data:application/x-font-woff;charset=utf-8;base64,d09GRgABAAAAAAfIAAsAAAAADDAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAADMAAABCsP6z7U9TLzIAAAE8AAAARAAAAFZW7kosY21hcAAAAYAAAADTAAACjtP6ytBnbHlmAAACVAAAAxgAAAQ4zRtvlGhlYWQAAAVsAAAALwAAADYRwZsnaGhlYQAABZwAAAAcAAAAJAeKAzxobXR4AAAFuAAAABIAAAA8OGQAAGxvY2EAAAXMAAAAIAAAACAG5AfwbWF4cAAABewAAAAfAAAAIAEfAERuYW1lAAAGDAAAAVcAAAKFkAhoC3Bvc3QAAAdkAAAAYgAAAK2vz7wkeJxjYGRgYOBikGPQYWB0cfMJYeBgYGGAAJAMY05meiJQDMoDyrGAaQ4gZoOIAgCKIwNPAHicY2BkPsQ4gYGVgYOpk+kMAwNDP4RmfM1gxMjBwMDEwMrMgBUEpLmmMDgwVLy4xKzzX4chhrmK4QpQmBEkBwAZygyweJzFkr0NwjAQhZ+TEP6CRUfHBEwRUWaQTICyQbpMwRCskA5RUIONxG0RnnNpKAIV4qzPku/8c353ACYAYrIjCWCuMAh2ptf0/hiL3p/gyPUWa3osqlt0L1zu9r71z8dGrJRykFoauXQd932Lj5vhG+MjxGeYI8MKETObMpslf5EyP8tg+vHun5r539PvlvXzaVhRFVQDTPEWKVQR90KhnnC5Ek67vUKN4VuFasM/ldARj43CCkCsEjpJSoVVgRyU0GVSK6wUpFFCx8lFgX0BiXpRPQB4nE2TTWjcRhTH3xttpDhxN7uxPlp3u/FK7moRPixafRijNosxSw/LUsIwNcaEHPZggo/FmEKMCKWU4kNOOftQSlhE8alnH0Ix9BqWnHooPRrTQ0+mnu2bXTu2pPdGM9LM/6c3fwECTM4gBBMYQNqxzLrZAjqYSlqu2TAHZQA0/DQJH6FtzqGDnvbt4Ggwvzw/nL8EfH8kW0fsuRqhgWXZnY7M1picaUL7Du5BHeDzMIl83dAt016wH1qmvtSMo5R6YRJHTR//FXsff/nj/tc/5K9P5d+nP22+fFK5u7v3K39SW3y+OtDKO3L85vD09PD9z5X17a2N1g4tqk01RlqX7gyoEmnsWQtVr4rtZMmukEaFBZxzefkCn11cyKMLZgshRwgTYNoLNXCBz2ja7HvZG7hDpPSNfoo5vs0knK/9hb+rNpu+8kHPgk/Ao4kK3tWtTpSEtvkA9c+wE6UaUdwieNkaHg55tBEtRiEPw1s0+FtrtTcc9two2lhMknV7PZF/cs6+uUFTmpTGbEx7sQCPSLOttHS3GRltqp7SNzVSKzl6aWnZT/CX5k6/v9N3Hh8fHBwffJVjhrC6OgH5dkIt/tPsq+d/PD5Qz7G7efzq1THFjdZVPe/N6ulQ3JnDWSE5junsFsVIiFwL/htf1S5gJ3BfOcUxfHKLnzqpFpyfZ9cX+/5WB6a+Y0pHpzkNrYNVDwMsikK+y7WuLCRg/oFHkA8VT3rDg5ZnU6ktzzINymV0m74Xd5pfIGXyFeVEQSShkzqG7TBBa2OxVRKitLXv7h3uuftXnXq7lz2tZ/WnWa9dx9dCjDhHzmuVQATlmljr9dZErUydSo2Hbi/b1vXtrOeGCk2/8s3ZlO8+ueJT8BVlw5pGw2oYccdSiHHqx0RlabHqdNR9jAETl6PreJcPBnnfpTLnOQ8C3OV8AmQGzouV1iZdeb5SSIoVc8W8/kcDtksUH5FrU6/aqBqNWcMEzxG4DAQ14qRQhi9mWU0rzepKezbjfgCwQKxVYq5ajRgpRqy45CqwkJydcEkbTkvRz8P5/2ZpDTN4nGNgZGBgAOKb6v+/xvPbfGXgZmEAgeuB2kkI+v8bFgbmKiCXg4EJJAoAPyAKhQB4nGNgZGBg1vmvwxDDwgACQJKRARXwAwAzZQHQeJxjYQCCFAYGFgbSMQAcWACdAAAAAAAAAAwALgBgAIQAmADSAQgBIgE8AVABoAHeAfwCHHicY2BkYGDgZ7BgYGMAASYg5gJCBob/YD4DAA/hAWQAeJxlkbtuwkAURMc88gApQomUJoq0TdIQzEOpUDokKCNR0BuzBiO/tF6QSJcPyHflE9Klyyekz2CuG8cr7547M3d9JQO4xjccnJ57vid2cMHqxDWc40G4Tv1JuEF+Fm6ijRfhM+oz4Ra6eBVu4wZvvMFpXLIa40PYQQefwjVc4Uu4Tv1HuEH+FW7i1mkKn6Hj3Am3sHC6wm08Ou8tpSZGe1av1PKggjSxPd8zJtSGTuinyVGa6/Uu8kxZludCmzxMEzV0B6U004k25W35fj2yNlCBSWM1paujKFWZSbfat+7G2mzc7weiu34aczzFNYGBhgfLfcV6iQP3ACkSaj349AxXSN9IT0j16JepOb01doiKbNWt1ovippz6sVYYwsXgX2rGVFIkq7Pl2PNrI6qW6eOshj0xaSq9mpNEZIWs8LZUfOouNkVXxp/d5woqebeYIf4D2J1ywQB4nG3LOw6AIBAE0B384B+PAkgEa+QwNnYmHt+EpXSal5lkSBBnoP8oCFSo0aCFRIceA0ZMmLFAYSW88rmvtMUjG3RiQ9HvpfusM6zWNmtc5H/iPewha50tOt5PS/QBx2IeSwAA") format("woff")}.admonition{box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12),0 3px 1px -2px rgba(0,0,0,.2);position:relative;margin:1.5625em 0;padding:0 1.2rem;border-left:.4rem solid rgba(68,138,255,.8);border-radius:.2rem;background-color:rgba(255,255,255,.05);overflow:auto}.admonition>p{margin-top:.8rem}.admonition>.admonition-title{margin:0 -1.2rem;padding:.8rem 1.2rem .8rem 3.6rem;border-bottom:1px solid rgba(68,138,255,.2);background-color:rgba(68,138,255,.1);font-weight:700}.admonition>.admonition-title:before{position:absolute;left:1.2rem;font-size:1.5rem;color:rgba(68,138,255,.8);content:"\E3C9"}.admonition>.admonition-title:before{font-family:Material Icons;font-style:normal;font-variant:normal;font-weight:400;line-height:2rem;text-transform:none;white-space:nowrap;speak:none;word-wrap:normal;direction:ltr}.admonition.abstract,.admonition.summary,.admonition.tldr{border-left-color:rgba(0,176,255,.8)}.admonition.abstract>.admonition-title,.admonition.summary>.admonition-title,.admonition.tldr>.admonition-title{background-color:rgba(0,176,255,.1);border-bottom-color:rgba(0,176,255,.2)}.admonition.abstract>.admonition-title:before,.admonition.summary>.admonition-title:before,.admonition.tldr>.admonition-title:before{color:#00b0ff;content:"\E8D2"}.admonition.hint,.admonition.tip{border-left-color:rgba(0,191,165,.8)}.admonition.hint>.admonition-title,.admonition.tip>.admonition-title{background-color:rgba(0,191,165,.1);border-bottom-color:rgba(0,191,165,.2)}.admonition.hint>.admonition-title:before,.admonition.tip>.admonition-title:before{color:#00bfa5;content:"\E80E"}.admonition.info,.admonition.todo{border-left-color:rgba(0,184,212,.8)}.admonition.info>.admonition-title,.admonition.todo>.admonition-title{background-color:rgba(0,184,212,.1);border-bottom-color:rgba(0,184,212,.2)}.admonition.info>.admonition-title:before,.admonition.todo>.admonition-title:before{color:#00b8d4;content:"\E88E"}.admonition.check,.admonition.done,.admonition.success{border-left-color:rgba(0,200,83,.8)}.admonition.check>.admonition-title,.admonition.done>.admonition-title,.admonition.success>.admonition-title{background-color:rgba(0,200,83,.1);border-bottom-color:rgba(0,200,83,.2)}.admonition.check>.admonition-title:before,.admonition.done>.admonition-title:before,.admonition.success>.admonition-title:before{color:#00c853;content:"\E876"}.admonition.faq,.admonition.help,.admonition.question{border-left-color:rgba(100,221,23,.8)}.admonition.faq>.admonition-title,.admonition.help>.admonition-title,.admonition.question>.admonition-title{background-color:rgba(100,221,23,.1);border-bottom-color:rgba(100,221,23,.2)}.admonition.faq>.admonition-title:before,.admonition.help>.admonition-title:before,.admonition.question>.admonition-title:before{color:#64dd17;content:"\E887"}.admonition.attention,.admonition.caution,.admonition.warning{border-left-color:rgba(255,145,0,.8)}.admonition.attention>.admonition-title,.admonition.caution>.admonition-title,.admonition.warning>.admonition-title{background-color:rgba(255,145,0,.1);border-bottom-color:rgba(255,145,0,.2)}.admonition.attention>.admonition-title:before{color:#ff9100;content:"\E417"}.admonition.caution>.admonition-title:before,.admonition.warning>.admonition-title:before{color:#ff9100;content:"\E002"}.admonition.fail,.admonition.failure,.admonition.missing{border-left-color:rgba(255,82,82,.8)}.admonition.fail>.admonition-title,.admonition.failure>.admonition-title,.admonition.missing>.admonition-title{background-color:rgba(255,82,82,.1);border-bottom-color:rgba(255,82,82,.2)}.admonition.fail>.admonition-title:before,.admonition.failure>.admonition-title:before,.admonition.missing>.admonition-title:before{color:#ff5252;content:"\E14C"}.admonition.bug,.admonition.danger,.admonition.error{border-left-color:rgba(255,23,68,.8)}.admonition.bug>.admonition-title,.admonition.danger>.admonition-title,.admonition.error>.admonition-title{background-color:rgba(255,23,68,.1);border-bottom-color:rgba(255,23,68,.2)}.admonition.danger>.admonition-title:before{color:#ff1744;content:"\E3E7"}.admonition.error>.admonition-title:before{color:#ff1744;content:"\E14C"}.admonition.bug>.admonition-title:before{color:#ff1744;content:"\E868"}.admonition.example,.admonition.snippet{border-left-color:rgba(0,184,212,.8)}.admonition.example>.admonition-title,.admonition.snippet>.admonition-title{background-color:rgba(0,184,212,.1);border-bottom-color:rgba(0,184,212,.2)}.admonition.example>.admonition-title:before,.admonition.snippet>.admonition-title:before{color:#00b8d4;content:"\E242"}.admonition.cite,.admonition.quote{border-left-color:rgba(158,158,158,.8)}.admonition.cite>.admonition-title,.admonition.quote>.admonition-title{background-color:rgba(158,158,158,.1);border-bottom-color:rgba(158,158,158,.2)}.admonition.cite>.admonition-title:before,.admonition.quote>.admonition-title:before{color:#9e9e9e;content:"\E244"}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

@font-face {
  font-family: 'Catamaran';
  font-style: normal;
  font-weight: 400;
  src: url(https://fonts.gstatic.com/s/catamaran/v28/o-0bIpQoyXQa2RxT7-5B6Ryxs2E_6n1iPHjd5a7dvg.ttf) format('truetype');
}
.markdown-preview.markdown-preview {
  font-family: Verdana, Arial, "Times New Roman", sans-serif;
  font-size: 14px;
}
.markdown-preview.markdown-preview .box_bg_lightgray {
  background-color: #f5f5f5;
  border: 2px solid #969696;
  padding: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
}
.markdown-preview.markdown-preview .box_bg_lightgreen {
  background-color: #f5faf5;
  border: 2px solid #969b96;
  padding-left: 15px;
  padding-right: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
}
.markdown-preview.markdown-preview .contenedor {
  display: flex;
  justify-content: center;
  margin: 30px auto 30px auto;
}
.markdown-preview.markdown-preview .fondo {
  background: url(https://ser.smr2.iesdoctorbalmis.info/assets/fondo.png);
  background-size: cover;
  width: 75%;
  height: 160px;
  border-radius: 10px;
  position: relative;
}
.markdown-preview.markdown-preview .cita {
  font-family: Arial;
  font-style: italic;
  font-weight: 600;
  text-align: justify;
  line-height: 1.5rem;
  opacity: 0.6;
  color: white;
  padding: 5rem;
  position: relative;
  top: 50%;
  left: 50%;
  font-size: 1.3rem;
  transform: translate(-50%, -50%);
}
.markdown-preview.markdown-preview .abre_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-left: 30px;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, -15%);
}
.markdown-preview.markdown-preview .cierra_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-right: 30px;
  right: 0%;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, 55%);
}
.markdown-preview.markdown-preview .autor {
  font-family: Arial;
  color: white;
  margin: 0px;
  padding-left: 30px;
  position: absolute;
  top: 83%;
  font-size: 1rem;
}
.markdown-preview.markdown-preview .flotante {
  display: flex;
  margin-top: 15px;
  margin-bottom: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    justify-content: center;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    justify-content: space-between;
  }
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    flex-direction: column;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    flex-direction: row;
  }
}
.markdown-preview.markdown-preview .flotante_izq {
  margin-right: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante_izq {
    width: 100%;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante_izq {
    width: auto;
  }
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante_der {
    width: 100%;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante_der {
    width: auto;
  }
}
.markdown-preview.markdown-preview .galeria_imagenes {
  display: flex;
  justify-content: space-evenly;
  align-items: center;
  margin-top: 15px;
  margin-bottom: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .galeria_imagenes {
    flex-direction: column;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .galeria_imagenes {
    flex-direction: row;
  }
}
.markdown-preview.markdown-preview table {
  table-layout: auto !important;
  width: fit-content !important;
  max-width: none !important;
  border-collapse: collapse !important;
}
.markdown-preview.markdown-preview .style-normal {
  text-indent: 0.5cm;
  text-align: justify;
}
.markdown-preview.markdown-preview .style-example {
  text-indent: 0cm;
  text-align: justify;
  font-size: small;
}
.markdown-preview.markdown-preview .style-note {
  text-align: justify;
  font-size: x-small;
}
.markdown-preview.markdown-preview .style-title {
  text-indent: 0cm;
  text-align: center;
}
.markdown-preview.markdown-preview .style-list {
  text-indent: 0cm;
  text-align: justify;
}
.markdown-preview.markdown-preview .style-table-content table {
  background-color: #f0f9ff !important;
  border-style: none !important;
  width: 100% !important;
  table-layout: fixed !important;
}
.markdown-preview.markdown-preview .style-table-content th,
.markdown-preview.markdown-preview .style-table-content td {
  border-style: none !important;
  vertical-align: top !important;
}
.markdown-preview.markdown-preview .style-table-content th:first-child,
.markdown-preview.markdown-preview .style-table-content td:first-child {
  width: 200px !important;
}
.markdown-preview.markdown-preview .md-toc {
  background-color: rgba(173, 216, 230, 0.4) !important;
}
.markdown-preview.markdown-preview pre,
.markdown-preview.markdown-preview code {
  page-break-inside: auto !important;
  break-inside: auto !important;
  white-space: pre-wrap;
}

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  const configureMermaidIconPacks = () => {
    window["mermaid"].registerIconPacks([
      {
        name: "logos",
        loader: () =>
          fetch("https://unpkg.com/@iconify-json/logos@1/icons.json").then(
            (res) => res.json()
          ),
      },
    ]);
  };

  if (document.readyState !== 'loading') {
    configureMermaidIconPacks();
  } else {
    document.addEventListener("DOMContentLoaded", () => {
      configureMermaidIconPacks();
    });
  }
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<div class="style-title">
<p><img src="../../../assets/img-BalmisHeader.png" alt="BALMIS"></p>
<h1 id="el-servicio-ftp">EL SERVICIO FTP </h1>
</div>
<p><a href="./t01.ftp.protocolo.pdf">Descargar PDF</a></p>

<div class="md-toc">
<details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#el-servicio-ftp" class="md-toc-link"><p>EL SERVICIO FTP</p>
</a>
          </summary>
        <div>
          <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#protocolo-ftp" class="md-toc-link"><p>PROTOCOLO FTP</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#introducci贸n" class="md-toc-link">
            <p>INTRODUCCIN</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#contexto-hist贸rico-y-estandarizaci贸n" class="md-toc-link">
            <p>CONTEXTO HISTRICO Y ESTANDARIZACIN</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#arquitectura-y-principios-de-funcionamiento" class="md-toc-link"><p>ARQUITECTURA Y PRINCIPIOS DE FUNCIONAMIENTO</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#sesi贸n-ftp" class="md-toc-link">
            <p>SESIN FTP</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#mecanismos-de-establecimiento-y-cierre-de-conexiones-tcp" class="md-toc-link"><p>MECANISMOS DE ESTABLECIMIENTO Y CIERRE DE CONEXIONES TCP</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#establecimiento-de-conexi贸n-three-way-handshake" class="md-toc-link">
            <p>ESTABLECIMIENTO DE CONEXIN: THREE-WAY HANDSHAKE</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#cierre-de-conexi贸n-four-way-y-two-way-handshake" class="md-toc-link">
            <p>CIERRE DE CONEXIN: FOUR-WAY Y TWO-WAY HANDSHAKE</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#usuarios-ftp" class="md-toc-link"><p>USUARIOS FTP</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#autenticaci贸n-acceso-an贸nimo-vs-acceso-autenticado" class="md-toc-link">
            <p>AUTENTICACIN: ACCESO ANNIMO VS. ACCESO AUTENTICADO</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#representaci贸n-usuarios-del-sistema-vs-usuarios-virtuales" class="md-toc-link">
            <p>REPRESENTACIN: USUARIOS DEL SISTEMA VS. USUARIOS VIRTUALES</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#grupos-y-permisos" class="md-toc-link">
            <p>GRUPOS Y PERMISOS</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#modos-de-conexi贸n-ftp" class="md-toc-link"><p>MODOS DE CONEXIN FTP</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#modo-activo" class="md-toc-link">
            <p>MODO ACTIVO</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#modo-pasivo" class="md-toc-link">
            <p>MODO PASIVO</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#comandos-ftp" class="md-toc-link"><p>COMANDOS FTP</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#referencia-de-comandos" class="md-toc-link">
            <p>REFERENCIA DE COMANDOS</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#c贸digos-de-respuesta" class="md-toc-link">
            <p>CDIGOS DE RESPUESTA</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#negociaci贸n-de-la-conexi贸n-de-datos" class="md-toc-link"><p>NEGOCIACIN DE LA CONEXIN DE DATOS</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#el-comando-port" class="md-toc-link">
            <p>EL COMANDO PORT</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#el-comando-pasv" class="md-toc-link">
            <p>EL COMANDO PASV</p>

          </a></div>
        </div>
      </details>
    <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#an谩lisis-del-protocolo-ftp" class="md-toc-link">
            <p>ANLISIS DEL PROTOCOLO FTP</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#seguridad-del-protocolo-ftp" class="md-toc-link"><p>SEGURIDAD DEL PROTOCOLO FTP</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#vulnerabilidades-principales" class="md-toc-link">
            <p>VULNERABILIDADES PRINCIPALES</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#alternativas-y-mejoras" class="md-toc-link">
            <p>ALTERNATIVAS Y MEJORAS</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    
</div>
<div style="page-break-after:always;"></div>
<h2 id="protocolo-ftp">PROTOCOLO FTP </h2>
<h3 id="introducci贸n">INTRODUCCIN </h3>
<div class="style-normal">
<p>El <strong>File Transfer Protocol (FTP)</strong> es un protocolo de la capa de aplicaci贸n dise帽ado para permitir la transferencia de archivos entre sistemas conectados a una red basada en TCP/IP. Su finalidad principal es proporcionar un mecanismo est谩ndar que permita a un usuario acceder a archivos almacenados en un sistema remoto y realizar operaciones como listar directorios, descargar archivos o subir contenido.</p>
<p>FTP fue durante muchos a帽os uno de los protocolos m谩s utilizados en Internet, especialmente para la publicaci贸n de p谩ginas web, la distribuci贸n de software y el intercambio de informaci贸n en redes acad茅micas y empresariales. Aunque en la actualidad ha sido sustituido en muchos entornos por alternativas m谩s seguras, sigue siendo un protocolo fundamental desde el punto de vista formativo, ya que permite comprender claramente el funcionamiento de los servicios de red cl谩sicos.</p>
<p>Desde una perspectiva did谩ctica, FTP resulta especialmente interesante porque hace expl铆citos muchos aspectos que en protocolos modernos quedan ocultos, como el uso de m煤ltiples conexiones TCP, la negociaci贸n de puertos o el intercambio de comandos en texto plano.</p>
</div>
<h3 id="contexto-hist贸rico-y-estandarizaci贸n">CONTEXTO HISTRICO Y ESTANDARIZACIN </h3>
<div class="style-normal">
<p>El protocolo FTP se desarroll贸 en los primeros a帽os de ARPANET, en una 茅poca en la que la seguridad no era una preocupaci贸n prioritaria y las redes estaban formadas por un n煤mero reducido de equipos de confianza. Su especificaci贸n principal est谩 recogida en el <strong>RFC 959</strong>, publicado en 1985, que define el funcionamiento b谩sico del protocolo tal y como sigue utiliz谩ndose hoy en d铆a.</p>
<p>A lo largo del tiempo se han publicado otros RFC que a帽aden extensiones o aclaran determinados comportamientos, pero el n煤cleo del protocolo apenas ha cambiado. Esto explica por qu茅 FTP conserva decisiones de dise帽o que hoy pueden parecer poco adecuadas, como la ausencia de cifrado o el uso de m煤ltiples conexiones.</p>
<p>FTP pertenece a la <strong>capa de aplicaci贸n</strong> del modelo TCP/IP y utiliza <strong>TCP</strong> como protocolo de transporte, lo que garantiza una comunicaci贸n fiable y orientada a conexi贸n.</p>
</div>
<h3 id="arquitectura-y-principios-de-funcionamiento">ARQUITECTURA Y PRINCIPIOS DE FUNCIONAMIENTO </h3>
<div class="style-normal">
<p>FTP utiliza una arquitectura <strong>cliente-servidor</strong>. El cliente inicia la conexi贸n y solicita servicios, mientras el servidor espera y responde a esas peticiones.</p>
<p>La clave de FTP es que emplea <strong>dos canales de comunicaci贸n independientes</strong>:</p>
</div>
<div class="style-list">
<ul>
<li>
<p><strong>Canal de control</strong>: Se usa para enviar comandos y recibir respuestas (por ejemplo, iniciar sesi贸n, pedir un archivo, cambiar de carpeta, etc.). Este canal permanece abierto durante toda la sesi贸n y normalmente utiliza el <strong>puerto TCP 21</strong> del servidor. La <strong>comunicaci贸n es en texto plano (ASCII)</strong>, lo que permite observar f谩cilmente el intercambio de comandos usando herramientas como <code>telnet</code>.</p>
</li>
<li>
<p><strong>Canal de datos</strong>: Se utiliza exclusivamente para transferir archivos o listados de directorios. La <strong>comunicaci贸n puede ser en texto plano o binaria</strong>, dependiendo del modo de transferencia. A diferencia del canal de control, esta conexi贸n se abre solo cuando es necesario transferir informaci贸n y se cierra al terminar. El <strong>puerto</strong> usado para el canal de datos <strong>var铆a seg煤n el modo de conexi贸n (activo o pasivo)</strong>, lo que puede complicar la configuraci贸n en redes con firewalls o NAT.</p>
</li>
</ul>
</div>
<div class="style-normal">
<p>Esta separaci贸n entre canales permite que los comandos y las transferencias de archivos no se mezclen, facilitando la gesti贸n y el control de la sesi贸n FTP.</p>
</div>
<h4 id="sesi贸n-ftp">SESIN FTP </h4>
<div class="style-list">
<p>El proceso t铆pico de una sesi贸n FTP incluye las siguientes fases:</p>
<ol>
<li>
<p><strong>Conexi贸n inicial</strong>: El cliente abre una conexi贸n TCP al puerto 21 del servidor (canal de control) y recibe un mensaje de bienvenida.</p>
</li>
<li>
<p><strong>Autenticaci贸n</strong>: El cliente env铆a su usuario (<code>USER</code>) y contrase帽a (<code>PASS</code>). El servidor valida las credenciales y permite el acceso.</p>
</li>
<li>
<p><strong>Comandos y transferencias</strong>: El cliente env铆a comandos FTP por el canal de control. Estos comandos pueden incluir operaciones de gesti贸n y control que no impliquen transferencia de datos o comandos que s铆 impliquen transferencia de datos (como <code>LIST</code>, <code>RETR</code>, <code>STOR</code>). Cuando se necesita transferir datos, se abre el canal de datos:</p>
<ul>
<li><strong>Modo activo</strong>: el servidor se conecta al cliente para transferir datos.</li>
<li><strong>Modo pasivo</strong>: el cliente se conecta al servidor para transferir datos.</li>
</ul>
<p>Cuando la transferencia termina, se cierra el canal de datos.</p>
</li>
<li>
<p><strong>Finalizaci贸n</strong>: El cliente env铆a el comando <code>QUIT</code> y el servidor cierra la sesi贸n y libera los recursos.</p>
</li>
</ol>
</div>
<h4 id="mecanismos-de-establecimiento-y-cierre-de-conexiones-tcp">MECANISMOS DE ESTABLECIMIENTO Y CIERRE DE CONEXIONES TCP </h4>
<div class="style-normal">
<p>Aunque FTP es un protocolo de aplicaci贸n, depende completamente de TCP para su funcionamiento. Comprender c贸mo TCP establece y cierra conexiones es fundamental para entender el flujo real de una sesi贸n FTP, especialmente cuando algo falla o hay comportamientos inesperados en la red.</p>
</div>
<h5 id="establecimiento-de-conexi贸n-three-way-handshake">ESTABLECIMIENTO DE CONEXIN: THREE-WAY HANDSHAKE </h5>
<div class="style-normal">
<p>Cuando un cliente FTP se conecta al servidor, TCP realiza un proceso llamado three-way handshake (apret贸n de manos de tres v铆as) para garantizar que ambos extremos est谩n preparados para comunicarse de forma confiable.</p>
</div> <div class="style-list">
<ul>
<li><strong>SYN</strong>: El cliente env铆a un segmento TCP con el flag SYN activado, indicando su intenci贸n de iniciar una conexi贸n. Este segmento incluye un n煤mero de secuencia inicial que el cliente ha elegido.</li>
<li><strong>SYN-ACK</strong>: El servidor recibe el SYN y responde con un segmento que tiene tanto el flag SYN como el flag ACK activados. Esto confirma que ha recibido el intento de conexi贸n del cliente y a su vez propone su propio n煤mero de secuencia inicial.</li>
<li><strong>ACK</strong>: El cliente recibe el SYN-ACK y responde con un segmento ACK, confirmando que ha recibido la respuesta del servidor. A partir de este momento, la conexi贸n est谩 completamente establecida y ambos lados pueden comenzar a intercambiar datos.</li>
</ul>
</div>
<p align="center" class="plantuml"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" data-diagram-type="SEQUENCE" height="229px" preserveAspectRatio="none" style="width:255px;height:229px;background:#FFFFFF;" version="1.1" viewBox="0 0 255 229" width="255px" zoomAndPan="magnify"><defs></defs><g><g><title>Cliente</title><rect fill="#000000" fill-opacity="0.00000" height="152.8241" width="8" x="30.7849" y="39.0679"></rect><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="34" x2="34" y1="39.0679" y2="191.892"></line></g><g><title>Servidor</title><rect fill="#000000" fill-opacity="0.00000" height="152.8241" width="8" x="211.24" y="39.0679"></rect><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="214.7651" x2="214.7651" y1="39.0679" y2="191.892"></line></g><g class="participant participant-head" data-participant="Cliente"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="59.5698" x="5" y="5"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45.5698" x="12" y="26.9659">Cliente</text></g><g class="participant participant-tail" data-participant="Cliente"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="59.5698" x="5" y="190.892"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45.5698" x="12" y="212.8579">Cliente</text></g><g class="participant participant-head" data-participant="Servidor"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.9498" x="180.7651" y="5"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.9498" x="187.7651" y="26.9659">Servidor</text></g><g class="participant participant-tail" data-participant="Servidor"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.9498" x="180.7651" y="190.892"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.9498" x="187.7651" y="212.8579">Servidor</text></g><g class="message" data-participant-1="Cliente" data-participant-2="Servidor"><polygon fill="#181818" points="203.24,68.7739,213.24,72.7739,203.24,76.7739,207.24,72.7739" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;" x1="34.7849" x2="209.24" y1="72.7739" y2="72.7739"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71.4221" x="41.7849" y="66.9649">SYN (seq=x)</text></g><g class="message" data-participant-1="Servidor" data-participant-2="Cliente"><polygon fill="#181818" points="45.7849,100.4799,35.7849,104.4799,45.7849,108.4799,41.7849,104.4799" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="39.7849" x2="214.24" y1="104.4799" y2="104.4799"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.4551" x="51.7849" y="98.6709">SYN-ACK (seq=y, ack=x+1)</text></g><g class="message" data-participant-1="Cliente" data-participant-2="Servidor"><polygon fill="#181818" points="203.24,132.186,213.24,136.186,203.24,140.186,207.24,136.186" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;" x1="34.7849" x2="209.24" y1="136.186" y2="136.186"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.7661" x="41.7849" y="130.377">ACK (seq=x+1, ack=y+1)</text></g><path d="M39,149.186 L39,176.186 L190,176.186 L190,159.186 L180,149.186 L39,149.186" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><path d="M180,149.186 L180,159.186 L190,159.186 L180,149.186" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0651" x="45" y="168.083">Conexi贸n establecida</text><!--SRC=[AqWiAibCpYn8p2jHSCx9JCqhIUKgG18BJYqgoqp9B-BYWiegwDh11HMi588Z_HGqYbCBRIiqkU32ka0rCELW9RgEpjuGPPKw2ed9sROLseQQE4o4AmMgWIYk12dEomUgBCfCpoXHo4z3CjqvFo-r8lFmvZo5rEAInAISrEJCb4G0]--></g></svg></p><div class="style-normal">
<p>En el contexto de FTP, este three-way handshake ocurre cada vez que el cliente intenta conectarse al puerto 21 del servidor. Si el servidor no responde en tiempo razonable, el cliente asume que el servidor est谩 inactivo o el puerto no est谩 disponible. Si el servidor rechaza (env铆a un RST), significa que no hay servicio FTP escuchando en ese puerto.</p>
</div>
<h5 id="cierre-de-conexi贸n-four-way-y-two-way-handshake">CIERRE DE CONEXIN: FOUR-WAY Y TWO-WAY HANDSHAKE </h5>
<div class="style-normal">
<p>El cierre de una conexi贸n TCP es un proceso m谩s complejo que tiene variantes seg煤n la situaci贸n. A diferencia del establecimiento (que es relativamente r铆gido), el cierre puede haber sido iniciado por cualquiera de los dos lados y puede ser ordenado o abrupto.</p>
</div>
<p><strong>Cierre ordenado (Four-Way Handshake)</strong></p>
<div class="style-normal">
<p>Cuando una conexi贸n se cierra de forma ordenada, ambos lados desean informar al otro que no van a enviar m谩s datos. Esto ocurre generalmente cuando un usuario ejecuta el comando FTP <code>QUIT</code> o cuando la aplicaci贸n termina normalmente.</p>
</div>
 <div class="style-list">
<ul>
<li><strong>FIN</strong>: Un lado (generalmente el cliente) env铆a un segmento TCP con el flag FIN activado, indicando que ha terminado de enviar datos y que desea cerrar la conexi贸n.</li>
<li><strong>ACK</strong>: El otro lado (el servidor) recibe el FIN y responde inmediatamente con un ACK, confirmando que ha entendido la solicitud de cierre. Sin embargo, el servidor podr铆a tener m谩s datos para enviar.</li>
<li><strong>FIN</strong>: Cuando el servidor tambi茅n ha terminado de enviar datos, env铆a su propio segmento FIN al cliente.</li>
<li><strong>ACK</strong>: El cliente recibe el FIN del servidor y responde con un ACK final. A partir de este momento, la conexi贸n est谩 completamente cerrada.</li>
</ul>
</div>
<p align="center" class="plantuml"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" data-diagram-type="SEQUENCE" height="374px" preserveAspectRatio="none" style="width:406px;height:374px;background:#FFFFFF;" version="1.1" viewBox="0 0 406 374" width="406px" zoomAndPan="magnify"><defs></defs><g><g><title>Cliente</title><rect fill="#000000" fill-opacity="0.00000" height="297.6481" width="8" x="30.7849" y="39.0679"></rect><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="34" x2="34" y1="39.0679" y2="336.716"></line></g><g><title>Servidor</title><rect fill="#000000" fill-opacity="0.00000" height="297.6481" width="8" x="197.551" y="39.0679"></rect><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="201.0761" x2="201.0761" y1="39.0679" y2="336.716"></line></g><g class="participant participant-head" data-participant="Cliente"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="59.5698" x="5" y="5"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45.5698" x="12" y="26.9659">Cliente</text></g><g class="participant participant-tail" data-participant="Cliente"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="59.5698" x="5" y="335.716"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45.5698" x="12" y="357.682">Cliente</text></g><g class="participant participant-head" data-participant="Servidor"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.9498" x="167.0761" y="5"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.9498" x="174.0761" y="26.9659">Servidor</text></g><g class="participant participant-tail" data-participant="Servidor"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.9498" x="167.0761" y="335.716"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.9498" x="174.0761" y="357.682">Servidor</text></g><g class="message" data-participant-1="Cliente" data-participant-2="Servidor"><polygon fill="#181818" points="189.551,68.7739,199.551,72.7739,189.551,76.7739,193.551,72.7739" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;" x1="34.7849" x2="195.551" y1="72.7739" y2="72.7739"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.4861" x="41.7849" y="66.9649">FIN (seq=x, ack=y)</text></g><path d="M39,85.7739 L39,112.7739 L224,112.7739 L224,95.7739 L214,85.7739 L39,85.7739" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><path d="M214,85.7739 L214,95.7739 L224,95.7739 L214,85.7739" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.0991" x="45" y="104.6709">Cliente no env铆a m谩s datos</text><g class="message" data-participant-1="Servidor" data-participant-2="Cliente"><polygon fill="#181818" points="45.7849,138.186,35.7849,142.186,45.7849,146.186,41.7849,142.186" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="39.7849" x2="200.551" y1="142.186" y2="142.186"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.8941" x="51.7849" y="136.377">ACK (seq=y, ack=x+1)</text></g><path d="M206,155.186 L206,182.186 L374,182.186 L374,165.186 L364,155.186 L206,155.186" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><path d="M364,155.186 L364,165.186 L374,165.186 L364,155.186" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.6671" x="212" y="174.083">Servidor confirma el FIN</text><g class="message" data-participant-1="Servidor" data-participant-2="Cliente"><polygon fill="#181818" points="45.7849,207.598,35.7849,211.598,45.7849,215.598,41.7849,211.598" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;" x1="39.7849" x2="200.551" y1="211.598" y2="211.598"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.3581" x="51.7849" y="205.789">FIN (seq=y, ack=x+1)</text></g><path d="M206,224.598 L206,251.598 L399,251.598 L399,234.598 L389,224.598 L206,224.598" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><path d="M389,224.598 L389,234.598 L399,234.598 L389,224.598" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.8091" x="212" y="243.495">Servidor no env铆a m谩s datos</text><g class="message" data-participant-1="Cliente" data-participant-2="Servidor"><polygon fill="#181818" points="189.551,277.01,199.551,281.01,189.551,285.01,193.551,281.01" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="34.7849" x2="195.551" y1="281.01" y2="281.01"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.7661" x="41.7849" y="275.201">ACK (seq=x+1, ack=y+1)</text></g><path d="M39,294.01 L39,321.01 L167,321.01 L167,304.01 L157,294.01 L39,294.01" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><path d="M157,294.01 L157,304.01 L167,304.01 L157,294.01" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.8481" x="45" y="312.907">Conexi贸n cerrada</text><!--SRC=[bP1B2i8m48RtESKi5Ut2hL112e88RZp1a4urs4vg6afx70_WoYFqOaRQnlZOk1lcySt7NwAnIgeIsKAIAs9BeWnw1pArIhKHmn2YbU_14ZRRFKmgkiJD752UutOgMBijeuud2peRcMvrh5W3STtT48hkMa6ALbV28oF7VzsiarsFRtjyCrjyFWXaV2arPyeK29G_3GDw2FVk_y5_-ljqtkFn_euz1FJz98X8CpMgkpD8CWPJV000]--></g></svg></p><p><strong>Cierre abrupto (Two-Way o Reset)</strong></p>
<div class="style-normal">
<p>En ocasiones, una conexi贸n se cierra de forma abrupta sin pasar por el proceso ordenado. Esto puede ocurrir por varias razones: un cliente desconecta abruptamente la red, se agota el tiempo de espera, o hay un error grave. En estos casos, uno de los lados env铆a un segmento con el flag RST (reset) activado, lo que indica al otro lado que la conexi贸n debe cerrarse inmediatamente sin intercambiar m谩s mensajes.</p>
</div>
<p align="center" class="plantuml"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" data-diagram-type="SEQUENCE" height="166px" preserveAspectRatio="none" style="width:346px;height:166px;background:#FFFFFF;" version="1.1" viewBox="0 0 346 166" width="346px" zoomAndPan="magnify"><defs></defs><g><g><title>Cliente</title><rect fill="#000000" fill-opacity="0.00000" height="89.412" width="8" x="30.7849" y="39.0679"></rect><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="34" x2="34" y1="39.0679" y2="128.4799"></line></g><g><title>Servidor</title><rect fill="#000000" fill-opacity="0.00000" height="89.412" width="8" x="302.5131" y="39.0679"></rect><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="306.0382" x2="306.0382" y1="39.0679" y2="128.4799"></line></g><g class="participant participant-head" data-participant="Cliente"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="59.5698" x="5" y="5"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45.5698" x="12" y="26.9659">Cliente</text></g><g class="participant participant-tail" data-participant="Cliente"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="59.5698" x="5" y="127.4799"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45.5698" x="12" y="149.4459">Cliente</text></g><g class="participant participant-head" data-participant="Servidor"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.9498" x="272.0382" y="5"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.9498" x="279.0382" y="26.9659">Servidor</text></g><g class="participant participant-tail" data-participant="Servidor"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.9498" x="272.0382" y="127.4799"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.9498" x="279.0382" y="149.4459">Servidor</text></g><g class="message" data-participant-1="Cliente" data-participant-2="Servidor"><polygon fill="#181818" points="294.5131,68.7739,304.5131,72.7739,294.5131,76.7739,298.5131,72.7739" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;" x1="34.7849" x2="300.5131" y1="72.7739" y2="72.7739"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247.7282" x="41.7849" y="66.9649">RST (conexi贸n terminada abruptamente)</text></g><path d="M39,85.7739 L39,112.7739 L162,112.7739 L162,95.7739 L152,85.7739 L39,85.7739" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><path d="M152,85.7739 L152,95.7739 L162,95.7739 L152,85.7739" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.4271" x="45" y="104.6709">Cierre inmediato</text><!--SRC=[JSsn3G9134JHVAkO408Q822v3ZWQCBS6HcBjbMKGVL42ZTqX0IBzewVf4ic9NImnNAcMMlfV6pNkh1wbV5PiTh-8BVRZ0Ql9JHzyFGsfqMXI1NACMqzfRxCkveiCdYy9FtsF5ZvG8nIqffMIFWC0]--></g></svg></p><div class="style-normal">
<p>En FTP, el four-way handshake ocurre cuando el usuario ejecuta normalmente QUIT, ordenando al cliente que cierre la conexi贸n de forma ordenada. El two-way (RST) puede ocurrir si el cliente se desconecta abruptamente, la red se interrumpe, o hay un timeout.</p>
</div>
<h2 id="usuarios-ftp">USUARIOS FTP </h2>
<div class="style-normal">
<p>Cuando hablamos de usuarios en FTP, en realidad estamos hablando de <strong>identidades</strong> que el servidor necesita reconocer para saber qui茅n se est谩 conectando y qu茅 puede hacer. Es importante entender que el protocolo FTP en s铆 no define c贸mo gestionar usuarios eso depende del sistema operativo y del servidor espec铆fico. Lo que s铆 define FTP es <strong>c贸mo una identidad se identifica ante el servidor</strong> (mediante los comandos <code>USER</code> y <code>PASS</code>) y las restricciones que se pueden aplicar.</p>
<p>Para entender mejor los usuarios FTP, es 煤til pensar en dos dimensiones diferentes: <strong>c贸mo se autentican</strong> (es decir, c贸mo prueban qui茅nes son) y <strong>qu茅 representan realmente</strong> en el sistema.</p>
</div>
<h3 id="autenticaci贸n-acceso-an贸nimo-vs-acceso-autenticado">AUTENTICACIN: ACCESO ANNIMO VS. ACCESO AUTENTICADO </h3>
<div class="style-normal">
<p>En t茅rminos de autenticaci贸n, FTP te ofrece dos opciones muy diferentes.</p>
<p><strong>El usuario an贸nimo</strong> es la opci贸n m谩s abierta. Imagina que quieres compartir unos archivos de forma p煤blica por ejemplo, una versi贸n de software o documentaci贸n que anyone puede acceder. Para esto, configuras un usuario especial que se llama <code>anonymous</code> (o a veces <code>ftp</code>). Cualquiera puede conectarse con este usuario sin necesidad de credenciales reales. Si te pregunta por contrase帽a, puedes poner "anonymous" o incluso una direcci贸n de correo. El servidor no verifica realmente qui茅n eres; solo asume que eres el mismo usuario an贸nimo que los dem谩s.</p>
<p>Por supuesto, el acceso an贸nimo tiene limitaciones de seguridad: no sabes realmente qui茅n est谩 accediendo, es dif铆cil rastrear acciones individuales, y el nivel de control es muy limitado. Generalmente se restringe a lectura 煤nicamente, aunque algunos servidores permiten un directorio especial para subidas (t铆picamente llamado <code>incoming</code>). Este modelo era com煤n en los primeros tiempos de Internet para distribuir software o documentaci贸n p煤blica, pero hoy en d铆a se usa cada vez menos.</p>
<p><strong>El usuario autenticado</strong> es lo opuesto: cada persona que se conecta usa su propio usuario y contrase帽a. Esto permite al servidor saber exactamente qui茅n accede, cu谩ndo lo hace y qu茅 hace. Es mucho m谩s seguro y trazable, y es el modelo que se usa en la mayor铆a de los entornos profesionales hoy en d铆a. Cada usuario puede tener sus propios permisos espec铆ficos, l铆mites de espacio, o incluso horarios de acceso.</p>
</div>
<h3 id="representaci贸n-usuarios-del-sistema-vs-usuarios-virtuales">REPRESENTACIN: USUARIOS DEL SISTEMA VS. USUARIOS VIRTUALES </h3>
<div class="style-normal">
<p>Ahora bien, independientemente de c贸mo se autentique un usuario, <strong>qu茅 representa realmente ese usuario en tu servidor</strong> es otra cuesti贸n importante.</p>
<p><strong>Un usuario del sistema</strong> es alguien que realmente existe como cuenta en tu sistema operativo. Cuando un usuario se conecta al FTP como "jose", esa cuenta tambi茅n existe en Linux o Windows aparece en el sistema de archivos, tiene un directorio de inicio, permisos espec铆ficos del SO, y puede usarse para otros servicios. El servidor FTP simplemente delega la autenticaci贸n al sistema operativo. Esto es simple de entender y funciona bien en entornos peque帽os o en configuraciones tradicionales.</p>
<p>Sin embargo, este modelo presenta un problema importante desde el punto de vista de la seguridad: si alguien compromete la cuenta FTP del usuario, tambi茅n compromete potencialmente la cuenta del sistema operativo. Adem谩s, si tienes muchos usuarios FTP, terminas con muchas cuentas de sistema, lo que puede complicar la gesti贸n y aumentar la superficie de ataque del servidor.</p>
<p><strong>Un usuario virtual</strong> es diferente: existe <strong>solo dentro del FTP</strong>. No hay una cuenta de sistema correspondiente. El servidor FTP mantiene su propia base de datos de usuarios y contrase帽as (que puede estar en un archivo, en una base de datos, o en un servidor LDAP), y gestiona internamente qu茅 archivos puede ver cada uno y con qu茅 permisos. Esto ofrece varias ventajas: mayor seguridad (un problema en FTP no afecta el resto del sistema), mejor escalabilidad (puedes tener cientos de usuarios virtuales sin saturar el sistema operativo), y mayor flexibilidad (puedes crear usuarios con pol铆ticas muy espec铆ficas sin que sean cuentas reales del SO).</p>
<p>Por eso, los usuarios virtuales son el modelo preferido en servidores de alojamiento (hosting), plataformas multiusuario, e infraestructuras empresariales modernas. Permiten un aislamiento efectivo entre los usuarios y un control mucho m谩s granular.</p>
</div>
<h3 id="grupos-y-permisos">GRUPOS Y PERMISOS </h3>
<div class="style-normal">
<p>Tanto si usas usuarios del sistema como virtuales, muchos servidores FTP te permiten agrupar usuarios para aplicar pol铆ticas comunes. Por ejemplo, podr铆as crear un grupo <em>clientes</em> que comparta ciertos permisos sobre directorios particulares, sin tener que configurar cada usuario individualmente.</p>
<p>Los permisos en FTP determinan qu茅 puede hacer cada usuario: si puede leer, escribir, eliminar archivos, qu茅 carpetas ve, cu谩nto espacio puede usar, a cu谩ntas conexiones simult谩neas tiene derecho, o incluso desde qu茅 direcciones IP puede conectarse.</p>
</div>
<h2 id="modos-de-conexi贸n-ftp">MODOS DE CONEXIN FTP </h2>
<div class="style-normal">
<p>El protocolo FTP define dos modos de operaci贸n distintos para establecer la conexi贸n de datos entre cliente y servidor: el <strong>modo activo</strong> y el <strong>modo pasivo</strong>. Ambos modos mantienen el mismo comportamiento para el canal de control (puerto TCP 21), pero difieren significativamente en c贸mo se establece y gestiona el canal de datos, lo que implica diferentes implicaciones para la arquitectura de red, configuraci贸n de firewalls y compatibilidad con sistemas NAT.</p>
<p>La elecci贸n del modo de conexi贸n tiene repercusiones directas en:</p>
</div>
<div class="style-list">
<ul>
<li>La arquitectura de las conexiones TCP y la direcci贸n en que se inician</li>
<li>La configuraci贸n requerida en sistemas de filtrado de tr谩fico (firewalls)</li>
<li>La compatibilidad con redes que emplean traducci贸n de direcciones (NAT)</li>
<li>El diagn贸stico y resoluci贸n de problemas de conectividad</li>
</ul>
</div>
<h3 id="modo-activo">MODO ACTIVO </h3>
<div class="style-normal">
<p>En el <strong>modo activo</strong>, el cliente desempe帽a un papel pasivo durante la transferencia de datos, permitiendo que el servidor inicie la conexi贸n hacia el cliente. Este modo constituye la implementaci贸n original descrita en el RFC 959 y sigue el siguiente procedimiento:</p>
</div>
<div class="style-list">
<ol>
<li>El cliente establece una <strong>conexi贸n TCP hacia el puerto 21</strong> del servidor (canal de control), mediante el que se mantiene la sesi贸n FTP.</li>
<li>Cuando el cliente requiere transferir datos, env铆a el comando <code>PORT</code> especificando su direcci贸n IP y el n煤mero de puerto en el que estar谩 escuchando conexiones entrantes.</li>
<li>El <strong>servidor responde confirmando la recepci贸n del comando <code>PORT</code></strong> y procede a iniciar una conexi贸n TCP desde su puerto 20 (o un puerto din谩mico configurado) hacia el puerto indicado por el cliente.</li>
<li>Una vez establecida la conexi贸n de datos, se realiza la transferencia de informaci贸n (descarga o carga de archivos/directorios).</li>
</ol>
<p><strong>Implicaciones t茅cnicas</strong>:</p>
<ul>
<li>El cliente debe estar configurado como servidor de puertos (escuchando conexiones entrantes).</li>
<li>El servidor inicia la conexi贸n de datos de forma activa hacia el cliente.</li>
<li>La implementaci贸n requiere que los firewalls del lado del cliente permitan conexiones TCP entrantes en puertos din谩micos.</li>
<li>La presencia de dispositivos NAT complica significativamente esta modalidad, ya que la direcci贸n IP comunicada al servidor puede no ser v谩lida desde su perspectiva de red.</li>
</ul>
</div>
<p align="center" class="plantuml"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" data-diagram-type="SEQUENCE" height="223px" preserveAspectRatio="none" style="width:280px;height:223px;background:#FFFFFF;" version="1.1" viewBox="0 0 280 223" width="280px" zoomAndPan="magnify"><defs></defs><g><g><title>Cliente</title><rect fill="#000000" fill-opacity="0.00000" height="146.8241" width="8" x="30.7849" y="39.0679"></rect><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="34" x2="34" y1="39.0679" y2="185.892"></line></g><g><title>Servidor</title><rect fill="#000000" fill-opacity="0.00000" height="146.8241" width="8" x="236.3951" y="39.0679"></rect><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="239.9202" x2="239.9202" y1="39.0679" y2="185.892"></line></g><g class="participant participant-head" data-participant="Cliente"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="59.5698" x="5" y="5"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45.5698" x="12" y="26.9659">Cliente</text></g><g class="participant participant-tail" data-participant="Cliente"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="59.5698" x="5" y="184.892"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45.5698" x="12" y="206.8579">Cliente</text></g><g class="participant participant-head" data-participant="Servidor"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.9498" x="205.9202" y="5"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.9498" x="212.9202" y="26.9659">Servidor</text></g><g class="participant participant-tail" data-participant="Servidor"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.9498" x="205.9202" y="184.892"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.9498" x="212.9202" y="206.8579">Servidor</text></g><g class="message" data-participant-1="Cliente" data-participant-2="Servidor"><polygon fill="#181818" points="228.3951,68.7739,238.3951,72.7739,228.3951,76.7739,232.3951,72.7739" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;" x1="34.7849" x2="234.3951" y1="72.7739" y2="72.7739"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.1371" x="41.7849" y="66.9649">TCP 21 (Control)</text></g><g class="message" data-participant-1="Servidor" data-participant-2="Cliente"><polygon fill="#181818" points="45.7849,100.4799,35.7849,104.4799,45.7849,108.4799,41.7849,104.4799" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="39.7849" x2="239.3951" y1="104.4799" y2="104.4799"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.2731" x="51.7849" y="98.6709">Respuesta comandos</text></g><g class="message" data-participant-1="Cliente" data-participant-2="Servidor"><polygon fill="#181818" points="228.3951,132.186,238.3951,136.186,228.3951,140.186,232.3951,136.186" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;" x1="34.7849" x2="234.3951" y1="136.186" y2="136.186"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.6102" x="41.7849" y="130.377">PORT (indica puerto de datos)</text></g><g class="message" data-participant-1="Servidor" data-participant-2="Cliente"><polygon fill="#181818" points="45.7849,163.892,35.7849,167.892,45.7849,171.892,41.7849,167.892" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;" x1="39.7849" x2="239.3951" y1="167.892" y2="167.892"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.5971" x="51.7849" y="162.083">TCP &lt;puerto&gt; (Datos)</text></g><!--SRC=[TOux3i8m44Hxds9AKwI0Ca9fJ4yKSe6LlOMbuBNi9USd_28tj3DldYPJqUXZfgHmI-IaR7AJtRYiCKWnvjkY6_OGFMOtudI4TPAqo78mUzTju6_JO-AQ7roLuELEAKZz8nolqmmRKuYUi4sA2W8Za4fjxQtyTUByOGVOonjz0W00]--></g></svg></p><h3 id="modo-pasivo">MODO PASIVO </h3>
<div class="style-normal">
<p>En el <strong>modo pasivo</strong>, el cliente act煤a como iniciador en ambas conexiones, permitiendo que el servidor permanezca pasivo durante el establecimiento de la conexi贸n de datos. Este modo fue introducido posteriormente como mejora para resolver las limitaciones del modo activo en ciertos contextos de red. El procedimiento es el siguiente:</p>
</div>
<div class="style-list">
<ol>
<li>El cliente establece una <strong>conexi贸n TCP hacia el puerto 21</strong> del servidor (canal de control), a trav茅s del cual se intercambiar谩n comandos FTP.</li>
<li>Cuando el cliente requiere realizar una operaci贸n de transferencia de datos, env铆a el comando <code>PASV</code> (Passive Mode) al servidor.</li>
<li>El <strong>servidor responde con el comando <code>227 Entering Passive Mode</code></strong>, indicando su direcci贸n IP y el n煤mero de puerto aleatorio que ha abierto para la transferencia de datos.</li>
<li>El cliente, recibida esta informaci贸n, <strong>inicia una nueva conexi贸n TCP hacia el puerto indicado por el servidor</strong> para establecer el canal de datos.</li>
<li>Se realiza la transferencia de informaci贸n mediante esta conexi贸n reci茅n establecida.</li>
</ol>
<p><strong>Implicaciones t茅cnicas</strong>:</p>
<ul>
<li>El cliente inicia ambas conexiones (control y datos), actuando como cliente en ambos casos.</li>
<li>El servidor adopta un rol pasivo en el establecimiento de la conexi贸n de datos, limit谩ndose a escuchar en un puerto asignado din谩micamente.</li>
<li>Esta modalidad elimina la necesidad de que los firewalls del cliente permitan conexiones entrantes, ya que todas las iniciativas de conexi贸n proceden del cliente.</li>
<li>La compatibilidad con NAT es sustancialmente mejorada, puesto que el cliente obtiene la informaci贸n del servidor desde su perspectiva de red.</li>
<li>Se ha convertido en el modo predominante en implementaciones modernas debido a su mayor compatibilidad con infraestructuras de red contempor谩neas.</li>
</ul>
</div>
<p align="center" class="plantuml"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" data-diagram-type="SEQUENCE" height="255px" preserveAspectRatio="none" style="width:285px;height:255px;background:#FFFFFF;" version="1.1" viewBox="0 0 285 255" width="285px" zoomAndPan="magnify"><defs></defs><g><g><title>Cliente</title><rect fill="#000000" fill-opacity="0.00000" height="178.5301" width="8" x="30.7849" y="39.0679"></rect><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="34" x2="34" y1="39.0679" y2="217.598"></line></g><g><title>Servidor</title><rect fill="#000000" fill-opacity="0.00000" height="178.5301" width="8" x="241.1921" y="39.0679"></rect><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="244.7172" x2="244.7172" y1="39.0679" y2="217.598"></line></g><g class="participant participant-head" data-participant="Cliente"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="59.5698" x="5" y="5"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45.5698" x="12" y="26.9659">Cliente</text></g><g class="participant participant-tail" data-participant="Cliente"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="59.5698" x="5" y="216.598"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45.5698" x="12" y="238.5639">Cliente</text></g><g class="participant participant-head" data-participant="Servidor"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.9498" x="210.7172" y="5"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.9498" x="217.7172" y="26.9659">Servidor</text></g><g class="participant participant-tail" data-participant="Servidor"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.9498" x="210.7172" y="216.598"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.9498" x="217.7172" y="238.5639">Servidor</text></g><g class="message" data-participant-1="Cliente" data-participant-2="Servidor"><polygon fill="#181818" points="233.1921,68.7739,243.1921,72.7739,233.1921,76.7739,237.1921,72.7739" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;" x1="34.7849" x2="239.1921" y1="72.7739" y2="72.7739"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.1371" x="41.7849" y="66.9649">TCP 21 (Control)</text></g><g class="message" data-participant-1="Servidor" data-participant-2="Cliente"><polygon fill="#181818" points="45.7849,100.4799,35.7849,104.4799,45.7849,108.4799,41.7849,104.4799" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="39.7849" x2="244.1921" y1="104.4799" y2="104.4799"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.2731" x="51.7849" y="98.6709">Respuesta comandos</text></g><g class="message" data-participant-1="Cliente" data-participant-2="Servidor"><polygon fill="#181818" points="233.1921,132.186,243.1921,136.186,233.1921,140.186,237.1921,136.186" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;" x1="34.7849" x2="239.1921" y1="136.186" y2="136.186"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.4072" x="41.7849" y="130.377">PASV (Solicita puerto de datos)</text></g><g class="message" data-participant-1="Servidor" data-participant-2="Cliente"><polygon fill="#181818" points="45.7849,163.892,35.7849,167.892,45.7849,171.892,41.7849,167.892" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="39.7849" x2="244.1921" y1="167.892" y2="167.892"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.0431" x="51.7849" y="162.083">Puerto disponible</text></g><g class="message" data-participant-1="Cliente" data-participant-2="Servidor"><polygon fill="#181818" points="233.1921,195.598,243.1921,199.598,233.1921,203.598,237.1921,199.598" style="stroke:#181818;stroke-width:1;"></polygon><line style="stroke:#181818;stroke-width:1;" x1="34.7849" x2="239.1921" y1="199.598" y2="199.598"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.5971" x="41.7849" y="193.789">TCP &lt;puerto&gt; (Datos)</text></g><!--SRC=[VOun3i8m40HxlsBBKAI0CaAHa7c0XH6zYQ-mP7oMVU7zM10Ycj3kpeusko9X2jabWOw1af3AFvcbyWoUYr9BYtvSGmouQeF37ftc98NZJgrTty3lPi25QfwfYiF43vSyrmsXETaREiknFMXq6nLXU89tmdNJRnOkrCmft2Fz-NlyI4TqvxVp1G00]--></g></svg></p><h2 id="comandos-ftp">COMANDOS FTP </h2>
<div class="style-normal">
<p>Los comandos FTP son instrucciones enviadas por el cliente al servidor a trav茅s del canal de control para realizar diversas operaciones relacionadas con la gesti贸n y transferencia de archivos. Estos comandos son en texto plano y siguen una sintaxis espec铆fica definida por el protocolo FTP. Se les conoce com煤nmente como <strong>comandos en crudo</strong> (<em>raw commands</em>) para diferenciarlos de las 贸rdenes que los usuarios pueden introducir en los clientes FTP.</p>
<p>El servidor responde a cada comando con un c贸digo num茅rico y un mensaje que indica el resultado de la operaci贸n solicitada.</p>
</div>
<h3 id="referencia-de-comandos">REFERENCIA DE COMANDOS </h3>
<div class="style-normal">
<p>La siguiente tabla recoge los principales comandos definidos por el protocolo FTP y su funci贸n real dentro de una sesi贸n:</p>
</div>
<table>
<thead>
<tr>
<th>Comando</th>
<th>Tipo</th>
<th>Descripci贸n</th>
</tr>
</thead>
<tbody>
<tr>
<td>USER &lt;usuario&gt;</td>
<td>Autenticaci贸n</td>
<td>Indica el nombre de usuario con el que se desea iniciar sesi贸n.</td>
</tr>
<tr>
<td>PASS &lt;contrase帽a&gt;</td>
<td>Autenticaci贸n</td>
<td>Env铆a la contrase帽a asociada al usuario.</td>
</tr>
<tr>
<td>QUIT</td>
<td>Control</td>
<td>Finaliza la sesi贸n FTP y cierra la conexi贸n de control.</td>
</tr>
<tr>
<td>PWD</td>
<td>Navegaci贸n</td>
<td>Muestra el directorio de trabajo actual en el servidor.</td>
</tr>
<tr>
<td>CWD</td>
<td>Navegaci贸n</td>
<td>Cambia el directorio de trabajo.</td>
</tr>
<tr>
<td>LIST</td>
<td>Transferencia</td>
<td>Solicita un listado detallado de archivos y directorios.</td>
</tr>
<tr>
<td>NLST</td>
<td>Transferencia</td>
<td>Solicita un listado simple de nombres de archivos.</td>
</tr>
<tr>
<td>RETR &lt;archivo&gt;</td>
<td>Transferencia</td>
<td>Descarga un archivo desde el servidor al cliente.</td>
</tr>
<tr>
<td>STOR &lt;archivo&gt;</td>
<td>Transferencia</td>
<td>Sube un archivo desde el cliente al servidor.</td>
</tr>
<tr>
<td>DELE &lt;archivo&gt;</td>
<td>Gesti贸n</td>
<td>Elimina un archivo del servidor.</td>
</tr>
<tr>
<td>TYPE &lt;tipo&gt;</td>
<td>Configuraci贸n</td>
<td>Establece el tipo de transferencia (ASCII o binaria).</td>
</tr>
<tr>
<td>PORT &lt;ip,puerto&gt;</td>
<td>Modo activo</td>
<td>Indica al servidor el puerto del cliente para la conexi贸n de datos.</td>
</tr>
<tr>
<td>PASV</td>
<td>Modo pasivo</td>
<td>Solicita al servidor que abra un puerto para la conexi贸n de datos.</td>
</tr>
<tr>
<td>SYST</td>
<td>Informaci贸n</td>
<td>Solicita informaci贸n sobre el sistema operativo del servidor.</td>
</tr>
<tr>
<td>NOOP</td>
<td>Control</td>
<td>No realiza ninguna acci贸n; se usa para mantener viva la conexi贸n.</td>
</tr>
</tbody>
</table>
<p>Estos comandos son independientes del sistema operativo y forman parte del est谩ndar FTP.</p>
<h3 id="c贸digos-de-respuesta">CDIGOS DE RESPUESTA </h3>
<div class="style-normal">
<p>Las respuestas del servidor FTP son mensajes enviados al cliente en respuesta a los comandos recibidos. Cada respuesta consta de un <strong>c贸digo num茅rico de tres d铆gitos</strong> seguido de un mensaje descriptivo. El c贸digo indica el resultado de la operaci贸n solicitada y se clasifica en varias categor铆as seg煤n su valor:</p>
<table>
<thead>
<tr>
<th>Categor铆a</th>
<th>Significado</th>
</tr>
</thead>
<tbody>
<tr>
<td>1xx</td>
<td>Respuesta preliminar (acci贸n en curso)</td>
</tr>
<tr>
<td>2xx</td>
<td>Acci贸n completada con 茅xito</td>
</tr>
<tr>
<td>3xx</td>
<td>Se necesita informaci贸n adicional</td>
</tr>
<tr>
<td>4xx</td>
<td>Error temporal</td>
</tr>
<tr>
<td>5xx</td>
<td>Error permanente</td>
</tr>
</tbody>
</table>
<p>La siguiente tabla recoge algunos de los c贸digos de respuesta m谩s habituales en una sesi贸n FTP:</p>
<table>
<thead>
<tr>
<th>C贸digo</th>
<th>Significado</th>
</tr>
</thead>
<tbody>
<tr>
<td>220</td>
<td>Servicio FTP listo</td>
</tr>
<tr>
<td>331</td>
<td>Usuario correcto, se necesita contrase帽a</td>
</tr>
<tr>
<td>230</td>
<td>Autenticaci贸n completada</td>
</tr>
<tr>
<td>150</td>
<td>Se va a abrir la conexi贸n de datos</td>
</tr>
<tr>
<td>226</td>
<td>Transferencia completada</td>
</tr>
<tr>
<td>530</td>
<td>Autenticaci贸n fallida</td>
</tr>
<tr>
<td>550</td>
<td>Archivo no disponible o acceso denegado</td>
</tr>
</tbody>
</table>
</div>
<h3 id="negociaci贸n-de-la-conexi贸n-de-datos">NEGOCIACIN DE LA CONEXIN DE DATOS </h3>
<div class="style-normal">
<p>La transferencia de datos en FTP requiere que cliente y servidor negocien c贸mo se establecer谩 la conexi贸n de datos. Existen dos comandos espec铆ficos para esta negociaci贸n: <code>PORT</code> (utilizado en modo activo) y <code>PASV</code> (utilizado en modo pasivo). Ambos comandos permiten que el cliente comunique al servidor (o que el servidor comunique al cliente) la informaci贸n necesaria para establecer el canal de datos de forma correcta.</p>
</div>
<h4 id="el-comando-port">EL COMANDO PORT </h4>
<div class="style-normal">
<p>El comando <code>PORT</code> es utilizado en el <strong>modo activo</strong> de FTP para indicar al servidor la direcci贸n IP y el puerto TCP en el que el cliente est谩 escuchando para la conexi贸n de datos. La sintaxis del comando es la siguiente:</p>
</div>
<pre data-role="codeBlock" data-info="text" class="language-text text"><code>PORT h1,h2,h3,h4,p1,p2
</code></pre><p>Donde:</p>
<div class="style-list">
<ul>
<li><code>h1,h2,h3,h4</code>: representan los cuatro octetos de la direcci贸n IP del cliente.</li>
<li><code>p1,p2</code>: representan el puerto TCP en el que el cliente est谩 escuchando, calculado como <code>p1*256 + p2</code>.</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Comando PORT</p>
<p>En el siguiente ejemplo se muestra un comando <code>PORT</code> t铆pico:</p>
<pre data-role="codeBlock" data-info="text" class="language-text text"><code>PORT 192,168,1,50,8,69
</code></pre><p>En este ejemplo, la direcci贸n IP del cliente es <code>192.168.1.50</code> y el puerto es <code>2077</code> (8*256 + 69). Tras recibir este comando, el servidor FTP intentar谩 establecer una conexi贸n TCP al puerto <code>2077</code> de la direcci贸n <code>192.168.1.50</code>.</p>
</div>
</div>
<h4 id="el-comando-pasv">EL COMANDO PASV </h4>
<div class="style-normal">
<p>El comando <code>PASV</code> es utilizado en el <strong>modo pasivo</strong> de FTP para solicitar al servidor que abra un puerto TCP para la conexi贸n de datos. Cuando el cliente env铆a el comando <code>PASV</code>, el servidor responde con un mensaje que incluye la direcci贸n IP y el puerto que el cliente debe usar para establecer la conexi贸n de datos. La respuesta del servidor tiene la siguiente estructura:</p>
</div>
<pre data-role="codeBlock" data-info="text" class="language-text text"><code>227 Entering Passive Mode (h1,h2,h3,h4,p1,p2)
</code></pre><p>Donde:</p>
<div class="style-list">
<ul>
<li><code>h1,h2,h3,h4</code>: representan los cuatro octetos de la direcci贸n IP del servidor.</li>
<li><code>p1,p2</code>: representan el puerto TCP que el servidor ha abierto para la conexi贸n de datos, calculado como <code>p1*256 + p2</code>.</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Comando PASV</p>
<p>En el siguiente ejemplo se muestra un comando <code>PASV</code> t铆pico:</p>
<pre data-role="codeBlock" data-info="text" class="language-text text"><code>PASV
</code></pre><p>En este ejemplo, el servidor responde con un mensaje como <code>227 Entering Passive Mode (192,168,1,50,8,69)</code>, indicando que el servidor est谩 escuchando en la direcci贸n <code>192.168.1.50</code> y el puerto <code>2077</code> (8*256 + 69). Tras recibir la respuesta del servidor, el cliente FTP intentar谩 establecer una conexi贸n TCP al puerto <code>2077</code> de la direcci贸n <code>192.168.1.50</code>.</p>
</div>
</div>
<h3 id="an谩lisis-del-protocolo-ftp">ANLISIS DEL PROTOCOLO FTP </h3>
<div class="style-normal">
<p>Los comandos FTP se env铆an a trav茅s del canal de control utilizando una conexi贸n TCP establecida entre el cliente y el servidor. Cada comando debe ser seguido por una secuencia de caracteres de nueva l铆nea (CRLF) para indicar el final del comando. Herramientas como <code>telnet</code> y/o netcat (<code>nc</code>) pueden utilizarse para enviar comandos FTP manualmente y observar las respuestas del servidor.</p>
</div>
<div class="style-list">
<div class="admonition example">
<p class="admonition-title">Sesi贸n FTP en modo activo</p>
<p>El siguiente ejemplo ilustra una sesi贸n FTP en modo activo utilizando <code>telnet</code> para la conexi贸n de control y <code>netcat</code> para la conexi贸n de datos. Nosuestra c贸mo un cliente FTP se conecta a un servidor (<code>192.168.10.251</code>), autentica al usuario (<code>jose</code> con contrase帽a <code>pepe</code>), solicita un listado de archivos (<code>LIST</code>) y cierra la sesi贸n.</p>
<div class="box_bg_lightgray">
<p><strong>Conexi贸n de control con Telnet</strong></p>
<p>Cliente-LX:~# telnet 192.168.10.251 21<br>
<em>Connected to 192.168.10.251<br>
220-FileZilla Server 0.9.60 beta<br>
220-written by Tim Kosse (<code>tim.kosse[at]filezilla-project.org</code>)<br>
220 Please visit <code>filezilla-project.org</code></em><br>
USER jose<br>
<em>331 Password required for jose</em><br>
PASS pepe<br>
<em>230 Logged on</em><br>
PORT 192,168,10,66,200,1<br>
<em>200 Port command successful</em><br>
LIST<br>
<em>150 Opening data channel for directory listing of "/"<br>
226 Successfully transferred "/"</em><br>
QUIT<br>
<em>221 Goodbye<br>
Connection closed by foreign host</em><br>
Cliente-LX:~#</p>
</div> <!-- fin caso de estudio -->
<p>Antes de ejecutar el comando <code>LIST</code>, es necesario abrir una conexi贸n de datos utilizando <code>netcat</code> en el puerto especificado en el comando <code>PORT</code> (en este caso, puerto <code>51201</code>, que se calcula como <code>200*256 + 1</code>).</p>
<div class="box_bg_lightgray">
<p><strong>Conexi贸n de datos con netcat</strong></p>
<p>Cliente-LX:~# nc -l -p 51201<br>
X1-L1:*# nc -l -p 51201<br>
-rw-r-xr-x 1 ftp ftp 136774728 Jan 12 09:59 Autofirma_64_v1_9_installer.exe<br>
-rw-r--r-- 1 ftp ftp        89 Jan 17 23:44 datos.txt<br>
-rw-r-xr-x 1 ftp ftp   2241216 Jan 17 22:18 filezilla-server-0-9-60-2.exe</p>
</div> <!-- fin caso de estudio -->
</div>
<div class="admonition example">
<p class="admonition-title">Sesi贸n FTP en modo pasivo</p>
<p>El siguiente ejemplo ilustra una sesi贸n FTP en modo pasivo utilizando <code>telnet</code> para la conexi贸n de control y <code>telnet</code> nuevamente para la conexi贸n de datos. Muestra c贸mo un cliente FTP se conecta a un servidor (<code>192.168.10.251</code>), autentica al usuario (<code>jose</code> con contrase帽a <code>pepe</code>), descarga un archivo (<code>RETR datos.txt</code>) y cierra la sesi贸n.</p>
<div class="box_bg_lightgray">
<p><strong>Conexi贸n de control con Telnet</strong></p>
<p>Cliente-LX:~# telnet 192.168.10.251 21<br>
<em>Connected to 192.168.10.251<br>
220-FileZilla Server 0.9.60 beta<br>
220-written by Tim Kosse (<code>tim.kosse@filezilla-project.org</code>)<br>
220 Please visit <code>https://filezilla-project.org/</code></em><br>
USER jose<br>
<em>331 Password required for jose</em><br>
PASS pepe<br>
<em>230 Logged on</em><br>
PASV<br>
<em>227 Entering Passive Mode (192,168,10,251,230,126)</em><br>
RETR datos.txt<br>
<em>150 Opening data channel for file download from server of "/datos.txt"<br>
226 Successfully transferred "/datos.txt"</em><br>
QUIT<br>
<em>221 Goodbye<br>
Connection closed by foreign host</em><br>
Cliente-LX:~#</p>
</div> <!-- fin caso de estudio -->
<p>Antes de ejecutar el comando <code>RETR</code>, es necesario abrir una conexi贸n de datos utilizando <code>telnet</code> en la direcci贸n IP y puerto especificados en la respuesta al comando <code>PASV</code> (en este caso, direcci贸n <code>192.168.10.251</code> y puerto <code>58878</code>, que se calcula como <code>230*256 + 126</code>).</p>
<div class="box_bg_lightgray">
<p><strong>Conexi贸n de datos con Telnet</strong></p>
<p>Cliente-LX:~# telnet 192.168.10.251 59006<br>
<em>Connected to 192.168.10.251</em><br>
Fichero de texto contiene 3 l铆neas<br>
Esta es la segunda l铆nea<br>
Esta es la tercera l铆nea<br>
<em>Connection closed by foreign host</em><br>
Cliente-LX:~#</p>
</div> <!-- fin caso de estudio -->
</div>
<h2 id="seguridad-del-protocolo-ftp">SEGURIDAD DEL PROTOCOLO FTP </h2>
<div class="style-normal">
<p>Aunque FTP fue fundamental en la historia de Internet, su dise帽o presenta vulnerabilidades significativas que lo hacen inadecuado para entornos donde la seguridad es una preocupaci贸n. Estas debilidades no son defectos accidentales, sino consecuencia de que el protocolo fue desarrollado en una 茅poca en la que la seguridad de la informaci贸n no era una prioridad, y las redes eran entornos controlados con un n煤mero reducido de usuarios de confianza.</p>
</div>
<h3 id="vulnerabilidades-principales">VULNERABILIDADES PRINCIPALES </h3>
<div class="style-list">
<p><strong>Transmisi贸n de credenciales sin protecci贸n</strong><br>
El aspecto m谩s cr铆tico es que tanto el usuario como la contrase帽a se env铆an en texto plano durante la autenticaci贸n. Cualquiera que capture el tr谩fico de red en la ruta entre cliente y servidor puede leer estas credenciales directamente. Esto es particularmente peligroso cuando la conexi贸n atraviesa redes p煤blicas o no confiables, donde t茅cnicas de captura de paquetes (sniffing) son relativamente sencillas.</p>
<p><strong>Datos transferidos sin cifrado</strong><br>
Los archivos se transmiten sin protecci贸n, lo que significa que cualquiera con acceso a la red puede interceptar y leer el contenido de los archivos transferidos. Esto viola la confidencialidad y puede exponer informaci贸n sensible.</p>
<p><strong>M煤ltiples puertos din谩micos</strong><br>
El uso de puertos din谩micos para la conexi贸n de datos complica significativamente la configuraci贸n de firewalls. No es posible simplemente abrir un puerto espec铆fico; los firewalls deben permitir un rango amplio de puertos, aumentando la superficie de ataque disponible.</p>
<p><strong>Vulnerabilidad a ataques de fuerza bruta</strong><br>
FTP no implementa mecanismos nativos para limitar intentos de conexi贸n fallidos. Los atacantes pueden enviar m煤ltiples intentos de autenticaci贸n sin experimentar penalizaciones significativas, facilitando ataques de fuerza bruta contra contrase帽as d茅biles.</p>
<p><strong>Falta de mecanismos de integridad</strong><br>
No hay forma de verificar que los datos transferidos no han sido modificados durante la transmisi贸n. Un atacante podr铆a interceptar y alterar archivos sin que el cliente o el servidor lo detecten.</p>
</div>
<h3 id="alternativas-y-mejoras">ALTERNATIVAS Y MEJORAS </h3>
<div class="style-normal">
<p>Frente a estos problemas, la comunidad de seguridad ha desarrollado varias soluciones:</p>
</div>
<div class="style-list">
<p><strong>FTPS (FTP Secure)</strong><br>
A帽ade una capa de cifrado TLS/SSL al protocolo FTP tradicional. Esto protege tanto las credenciales como los datos transferidos, abordando las vulnerabilidades m谩s cr铆ticas. Sin embargo, mantiene la complejidad del protocolo original (m煤ltiples conexiones, puertos din谩micos).</p>
<p><strong>SFTP (SSH File Transfer Protocol)</strong><br>
Basado completamente en SSH, ofrece una alternativa m谩s moderna y segura. SFTP opera sobre una 煤nica conexi贸n encriptada, elimina la complejidad de los puertos din谩micos, y es considerado significativamente m谩s seguro. Es la opci贸n recomendada para nuevas implementaciones.</p>
<p><strong>Configuraci贸n y restricciones del servidor</strong><br>
Incluso con FTP tradicional, es posible mejorar la seguridad mediante pol铆ticas administrativas: desactivar el acceso an贸nimo si no es absolutamente necesario, mantener contrase帽as robustas, limitar el acceso por direcci贸n IP, y usar firewalls configurados adecuadamente. Sin embargo, estas medidas son limitadas frente a los problemas inherentes del protocolo.</p>
<p><strong>Auditor铆a y monitoreo</strong><br>
Registrar todas las actividades FTP permite detectar patrones sospechosos y responder a incidentes. Los logs pueden revelar intentos de acceso fallidos, transferencias inusuales, o comportamientos an贸micos.</p>
</div>
</div>
      </div>
      
      
    
    
    
    
    
    
  
    </body></html>