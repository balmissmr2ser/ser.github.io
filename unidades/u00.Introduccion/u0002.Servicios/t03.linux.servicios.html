<!DOCTYPE html><html><head>
      <title>SER</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css">
      
      
      
      
      
      <style>
      @import url(https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css);
code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}@font-face{font-family:"Material Icons";font-style:normal;font-weight:400;src:local("Material Icons"),local("MaterialIcons-Regular"),url("data:application/x-font-woff;charset=utf-8;base64,d09GRgABAAAAAAfIAAsAAAAADDAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAADMAAABCsP6z7U9TLzIAAAE8AAAARAAAAFZW7kosY21hcAAAAYAAAADTAAACjtP6ytBnbHlmAAACVAAAAxgAAAQ4zRtvlGhlYWQAAAVsAAAALwAAADYRwZsnaGhlYQAABZwAAAAcAAAAJAeKAzxobXR4AAAFuAAAABIAAAA8OGQAAGxvY2EAAAXMAAAAIAAAACAG5AfwbWF4cAAABewAAAAfAAAAIAEfAERuYW1lAAAGDAAAAVcAAAKFkAhoC3Bvc3QAAAdkAAAAYgAAAK2vz7wkeJxjYGRgYOBikGPQYWB0cfMJYeBgYGGAAJAMY05meiJQDMoDyrGAaQ4gZoOIAgCKIwNPAHicY2BkPsQ4gYGVgYOpk+kMAwNDP4RmfM1gxMjBwMDEwMrMgBUEpLmmMDgwVLy4xKzzX4chhrmK4QpQmBEkBwAZygyweJzFkr0NwjAQhZ+TEP6CRUfHBEwRUWaQTICyQbpMwRCskA5RUIONxG0RnnNpKAIV4qzPku/8c353ACYAYrIjCWCuMAh2ptf0/hiL3p/gyPUWa3osqlt0L1zu9r71z8dGrJRykFoauXQd932Lj5vhG+MjxGeYI8MKETObMpslf5EyP8tg+vHun5r539PvlvXzaVhRFVQDTPEWKVQR90KhnnC5Ek67vUKN4VuFasM/ldARj43CCkCsEjpJSoVVgRyU0GVSK6wUpFFCx8lFgX0BiXpRPQB4nE2TTWjcRhTH3xttpDhxN7uxPlp3u/FK7moRPixafRijNosxSw/LUsIwNcaEHPZggo/FmEKMCKWU4kNOOftQSlhE8alnH0Ix9BqWnHooPRrTQ0+mnu2bXTu2pPdGM9LM/6c3fwECTM4gBBMYQNqxzLrZAjqYSlqu2TAHZQA0/DQJH6FtzqGDnvbt4Ggwvzw/nL8EfH8kW0fsuRqhgWXZnY7M1picaUL7Du5BHeDzMIl83dAt016wH1qmvtSMo5R6YRJHTR//FXsff/nj/tc/5K9P5d+nP22+fFK5u7v3K39SW3y+OtDKO3L85vD09PD9z5X17a2N1g4tqk01RlqX7gyoEmnsWQtVr4rtZMmukEaFBZxzefkCn11cyKMLZgshRwgTYNoLNXCBz2ja7HvZG7hDpPSNfoo5vs0knK/9hb+rNpu+8kHPgk/Ao4kK3tWtTpSEtvkA9c+wE6UaUdwieNkaHg55tBEtRiEPw1s0+FtrtTcc9two2lhMknV7PZF/cs6+uUFTmpTGbEx7sQCPSLOttHS3GRltqp7SNzVSKzl6aWnZT/CX5k6/v9N3Hh8fHBwffJVjhrC6OgH5dkIt/tPsq+d/PD5Qz7G7efzq1THFjdZVPe/N6ulQ3JnDWSE5junsFsVIiFwL/htf1S5gJ3BfOcUxfHKLnzqpFpyfZ9cX+/5WB6a+Y0pHpzkNrYNVDwMsikK+y7WuLCRg/oFHkA8VT3rDg5ZnU6ktzzINymV0m74Xd5pfIGXyFeVEQSShkzqG7TBBa2OxVRKitLXv7h3uuftXnXq7lz2tZ/WnWa9dx9dCjDhHzmuVQATlmljr9dZErUydSo2Hbi/b1vXtrOeGCk2/8s3ZlO8+ueJT8BVlw5pGw2oYccdSiHHqx0RlabHqdNR9jAETl6PreJcPBnnfpTLnOQ8C3OV8AmQGzouV1iZdeb5SSIoVc8W8/kcDtksUH5FrU6/aqBqNWcMEzxG4DAQ14qRQhi9mWU0rzepKezbjfgCwQKxVYq5ajRgpRqy45CqwkJydcEkbTkvRz8P5/2ZpDTN4nGNgZGBgAOKb6v+/xvPbfGXgZmEAgeuB2kkI+v8bFgbmKiCXg4EJJAoAPyAKhQB4nGNgZGBg1vmvwxDDwgACQJKRARXwAwAzZQHQeJxjYQCCFAYGFgbSMQAcWACdAAAAAAAAAAwALgBgAIQAmADSAQgBIgE8AVABoAHeAfwCHHicY2BkYGDgZ7BgYGMAASYg5gJCBob/YD4DAA/hAWQAeJxlkbtuwkAURMc88gApQomUJoq0TdIQzEOpUDokKCNR0BuzBiO/tF6QSJcPyHflE9Klyyekz2CuG8cr7547M3d9JQO4xjccnJ57vid2cMHqxDWc40G4Tv1JuEF+Fm6ijRfhM+oz4Ra6eBVu4wZvvMFpXLIa40PYQQefwjVc4Uu4Tv1HuEH+FW7i1mkKn6Hj3Am3sHC6wm08Ou8tpSZGe1av1PKggjSxPd8zJtSGTuinyVGa6/Uu8kxZludCmzxMEzV0B6U004k25W35fj2yNlCBSWM1paujKFWZSbfat+7G2mzc7weiu34aczzFNYGBhgfLfcV6iQP3ACkSaj349AxXSN9IT0j16JepOb01doiKbNWt1ovippz6sVYYwsXgX2rGVFIkq7Pl2PNrI6qW6eOshj0xaSq9mpNEZIWs8LZUfOouNkVXxp/d5woqebeYIf4D2J1ywQB4nG3LOw6AIBAE0B384B+PAkgEa+QwNnYmHt+EpXSal5lkSBBnoP8oCFSo0aCFRIceA0ZMmLFAYSW88rmvtMUjG3RiQ9HvpfusM6zWNmtc5H/iPewha50tOt5PS/QBx2IeSwAA") format("woff")}.admonition{box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12),0 3px 1px -2px rgba(0,0,0,.2);position:relative;margin:1.5625em 0;padding:0 1.2rem;border-left:.4rem solid rgba(68,138,255,.8);border-radius:.2rem;background-color:rgba(255,255,255,.05);overflow:auto}.admonition>p{margin-top:.8rem}.admonition>.admonition-title{margin:0 -1.2rem;padding:.8rem 1.2rem .8rem 3.6rem;border-bottom:1px solid rgba(68,138,255,.2);background-color:rgba(68,138,255,.1);font-weight:700}.admonition>.admonition-title:before{position:absolute;left:1.2rem;font-size:1.5rem;color:rgba(68,138,255,.8);content:"\E3C9"}.admonition>.admonition-title:before{font-family:Material Icons;font-style:normal;font-variant:normal;font-weight:400;line-height:2rem;text-transform:none;white-space:nowrap;speak:none;word-wrap:normal;direction:ltr}.admonition.abstract,.admonition.summary,.admonition.tldr{border-left-color:rgba(0,176,255,.8)}.admonition.abstract>.admonition-title,.admonition.summary>.admonition-title,.admonition.tldr>.admonition-title{background-color:rgba(0,176,255,.1);border-bottom-color:rgba(0,176,255,.2)}.admonition.abstract>.admonition-title:before,.admonition.summary>.admonition-title:before,.admonition.tldr>.admonition-title:before{color:#00b0ff;content:"\E8D2"}.admonition.hint,.admonition.tip{border-left-color:rgba(0,191,165,.8)}.admonition.hint>.admonition-title,.admonition.tip>.admonition-title{background-color:rgba(0,191,165,.1);border-bottom-color:rgba(0,191,165,.2)}.admonition.hint>.admonition-title:before,.admonition.tip>.admonition-title:before{color:#00bfa5;content:"\E80E"}.admonition.info,.admonition.todo{border-left-color:rgba(0,184,212,.8)}.admonition.info>.admonition-title,.admonition.todo>.admonition-title{background-color:rgba(0,184,212,.1);border-bottom-color:rgba(0,184,212,.2)}.admonition.info>.admonition-title:before,.admonition.todo>.admonition-title:before{color:#00b8d4;content:"\E88E"}.admonition.check,.admonition.done,.admonition.success{border-left-color:rgba(0,200,83,.8)}.admonition.check>.admonition-title,.admonition.done>.admonition-title,.admonition.success>.admonition-title{background-color:rgba(0,200,83,.1);border-bottom-color:rgba(0,200,83,.2)}.admonition.check>.admonition-title:before,.admonition.done>.admonition-title:before,.admonition.success>.admonition-title:before{color:#00c853;content:"\E876"}.admonition.faq,.admonition.help,.admonition.question{border-left-color:rgba(100,221,23,.8)}.admonition.faq>.admonition-title,.admonition.help>.admonition-title,.admonition.question>.admonition-title{background-color:rgba(100,221,23,.1);border-bottom-color:rgba(100,221,23,.2)}.admonition.faq>.admonition-title:before,.admonition.help>.admonition-title:before,.admonition.question>.admonition-title:before{color:#64dd17;content:"\E887"}.admonition.attention,.admonition.caution,.admonition.warning{border-left-color:rgba(255,145,0,.8)}.admonition.attention>.admonition-title,.admonition.caution>.admonition-title,.admonition.warning>.admonition-title{background-color:rgba(255,145,0,.1);border-bottom-color:rgba(255,145,0,.2)}.admonition.attention>.admonition-title:before{color:#ff9100;content:"\E417"}.admonition.caution>.admonition-title:before,.admonition.warning>.admonition-title:before{color:#ff9100;content:"\E002"}.admonition.fail,.admonition.failure,.admonition.missing{border-left-color:rgba(255,82,82,.8)}.admonition.fail>.admonition-title,.admonition.failure>.admonition-title,.admonition.missing>.admonition-title{background-color:rgba(255,82,82,.1);border-bottom-color:rgba(255,82,82,.2)}.admonition.fail>.admonition-title:before,.admonition.failure>.admonition-title:before,.admonition.missing>.admonition-title:before{color:#ff5252;content:"\E14C"}.admonition.bug,.admonition.danger,.admonition.error{border-left-color:rgba(255,23,68,.8)}.admonition.bug>.admonition-title,.admonition.danger>.admonition-title,.admonition.error>.admonition-title{background-color:rgba(255,23,68,.1);border-bottom-color:rgba(255,23,68,.2)}.admonition.danger>.admonition-title:before{color:#ff1744;content:"\E3E7"}.admonition.error>.admonition-title:before{color:#ff1744;content:"\E14C"}.admonition.bug>.admonition-title:before{color:#ff1744;content:"\E868"}.admonition.example,.admonition.snippet{border-left-color:rgba(0,184,212,.8)}.admonition.example>.admonition-title,.admonition.snippet>.admonition-title{background-color:rgba(0,184,212,.1);border-bottom-color:rgba(0,184,212,.2)}.admonition.example>.admonition-title:before,.admonition.snippet>.admonition-title:before{color:#00b8d4;content:"\E242"}.admonition.cite,.admonition.quote{border-left-color:rgba(158,158,158,.8)}.admonition.cite>.admonition-title,.admonition.quote>.admonition-title{background-color:rgba(158,158,158,.1);border-bottom-color:rgba(158,158,158,.2)}.admonition.cite>.admonition-title:before,.admonition.quote>.admonition-title:before{color:#9e9e9e;content:"\E244"}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

@font-face {
  font-family: 'Catamaran';
  font-style: normal;
  font-weight: 400;
  src: url(https://fonts.gstatic.com/s/catamaran/v28/o-0bIpQoyXQa2RxT7-5B6Ryxs2E_6n1iPHjd5a7dvg.ttf) format('truetype');
}
.markdown-preview.markdown-preview {
  font-family: Verdana, Arial, "Times New Roman", sans-serif;
  font-size: 14px;
}
.markdown-preview.markdown-preview .box_bg_lightgray {
  background-color: #f5f5f5;
  border: 2px solid #969696;
  padding: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
}
.markdown-preview.markdown-preview .box_bg_lightgreen {
  background-color: #f5faf5;
  border: 2px solid #969b96;
  padding-left: 15px;
  padding-right: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
}
.markdown-preview.markdown-preview .contenedor {
  display: flex;
  justify-content: center;
  margin: 30px auto 30px auto;
}
.markdown-preview.markdown-preview .fondo {
  background: url(https://ser.smr2.iesdoctorbalmis.info/assets/fondo.png);
  background-size: cover;
  width: 75%;
  height: 160px;
  border-radius: 10px;
  position: relative;
}
.markdown-preview.markdown-preview .cita {
  font-family: Arial;
  font-style: italic;
  font-weight: 600;
  text-align: justify;
  line-height: 1.5rem;
  opacity: 0.6;
  color: white;
  padding: 5rem;
  position: relative;
  top: 50%;
  left: 50%;
  font-size: 1.3rem;
  transform: translate(-50%, -50%);
}
.markdown-preview.markdown-preview .abre_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-left: 30px;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, -15%);
}
.markdown-preview.markdown-preview .cierra_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-right: 30px;
  right: 0%;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, 55%);
}
.markdown-preview.markdown-preview .autor {
  font-family: Arial;
  color: white;
  margin: 0px;
  padding-left: 30px;
  position: absolute;
  top: 83%;
  font-size: 1rem;
}
.markdown-preview.markdown-preview .flotante {
  display: flex;
  margin-top: 15px;
  margin-bottom: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    justify-content: center;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    justify-content: space-between;
  }
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    flex-direction: column;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    flex-direction: row;
  }
}
.markdown-preview.markdown-preview .flotante_izq {
  margin-right: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante_izq {
    width: 100%;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante_izq {
    width: auto;
  }
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante_der {
    width: 100%;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante_der {
    width: auto;
  }
}
.markdown-preview.markdown-preview .galeria_imagenes {
  display: flex;
  justify-content: space-evenly;
  align-items: center;
  margin-top: 15px;
  margin-bottom: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .galeria_imagenes {
    flex-direction: column;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .galeria_imagenes {
    flex-direction: row;
  }
}
.markdown-preview.markdown-preview table {
  table-layout: auto !important;
  width: fit-content !important;
  max-width: none !important;
  border-collapse: collapse !important;
}
.markdown-preview.markdown-preview .style-normal {
  text-indent: 0.5cm;
  text-align: justify;
}
.markdown-preview.markdown-preview .style-normal2 {
  text-align: justify;
}
.markdown-preview.markdown-preview .style-example {
  text-align: justify;
  font-size: small;
}
.markdown-preview.markdown-preview .style-title {
  text-indent: 0cm;
  text-align: center;
}
.markdown-preview.markdown-preview .style-list {
  text-indent: 0cm;
  text-align: justify;
}
.markdown-preview.markdown-preview .style-table-content {
  background-color: lightgrey;
}

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  const configureMermaidIconPacks = () => {
    window["mermaid"].registerIconPacks([
      {
        name: "logos",
        loader: () =>
          fetch("https://unpkg.com/@iconify-json/logos@1/icons.json").then(
            (res) => res.json()
          ),
      },
    ]);
  };

  if (document.readyState !== 'loading') {
    configureMermaidIconPacks();
  } else {
    document.addEventListener("DOMContentLoaded", () => {
      configureMermaidIconPacks();
    });
  }
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<style type="text/css">
  <!-- estilos internos al fichero -->
</style>
<p><img src="..\..\..\assets\img-BalmisHeader.png" alt="BALMIS"></p>
<div class="style-title">
<h1 id="servicios-br-linux">SERVICIOS <br> LINUX </h1>
</div>
<p>📙<a href="./t03.linux.servicios.pdf">Descargar PDF</a></p>
<h2 id="índice">ÍNDICE </h2>
<div class="style-table-content">

<div class="md-toc">
<details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#servicios-linux" class="md-toc-link"><p>SERVICIOS LINUX</p>
</a>
          </summary>
        <div>
          <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#system-v" class="md-toc-link"><p>SYSTEM V</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#servicios" class="md-toc-link">
            <p>SERVICIOS</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#operaciones" class="md-toc-link">
            <p>OPERACIONES</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#runlevels" class="md-toc-link">
            <p>RUNLEVELS</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#inittab" class="md-toc-link">
            <p>INITTAB</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#ficheros-de-log" class="md-toc-link">
            <p>FICHEROS DE LOG</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#systemd" class="md-toc-link"><p>SYSTEMD</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#servicios-1" class="md-toc-link">
            <p>SERVICIOS</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#runlevels-1" class="md-toc-link">
            <p>RUNLEVELS</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#operaciones-1" class="md-toc-link">
            <p>OPERACIONES</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#ficheros-de-log-1" class="md-toc-link">
            <p>FICHEROS DE LOG</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    
</div>
</div>
<div style="page-break-after:always;"></div>
<h2 id="servicios-linux">SERVICIOS LINUX </h2>
<div class="style-normal">
<p>Los sistemas de inicio son el primer proceso del sistema (PID 1) y son los responsables de arrancar la máquina, iniciar servicios y administrar el resto de procesos del sistema. En las distribuciones Linux podemos encontrar dos sistemas inicio diferentes.</p>
<ul>
<li><strong>system V</strong>    distribuciones Linux antiguas (1983).</li>
<li><strong>systemD</strong>     distribuciones Linux modernas (2010).</li>
</ul>
</div>
<div class="style-example">
<div class="admonition tip">
<p class="admonition-title">¿system V o systemd?</p>
<p>Comprobar proceso con PID 1</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token comment"># Ejemplo sistema System V</span>
<span class="token function">ps</span> <span class="token parameter variable">-p</span> <span class="token number">1</span>
PID  <span class="token environment constant">USER</span>   TIME  COMMAND
<span class="token number">1</span>    root   <span class="token number">0</span>:00  /sbin/init
<span class="token comment"># Ejemplo sistema systemD</span>
<span class="token function">ps</span> <span class="token parameter variable">-p</span> <span class="token number">1</span>
PID  <span class="token environment constant">USER</span>   TIME COMMAND
<span class="token number">1</span>    root   <span class="token number">0</span>:00 systemd
</code></pre></div>
</div>
<h3 id="system-v">SYSTEM V </h3>
<div class="style-normal">
<p>Denominado también UNIX System V o SysVinit. El proceso inicial se llama <code>init</code> y ejecuta el comando <code>/sbin/init</code> con PID 1. La <strong>ejecución</strong> de los servicios se realiza <strong>secuencialmente</strong>, es decir, cuando lanza la ejecución de un servicio espera a que termine antes de lanzar el siguiente. No existe definición explicita de dependencias más allá del orden en la ejecución secuencial.</p>
</div>
<h4 id="servicios">SERVICIOS </h4>
<div class="style-normal">
<p>Los scripts que definen los servicios están ubicados en la carpeta <code>/etc/init.d</code> o <code>/etc/rc.d/init.d</code> dependiendo de la distribución Linux. Un script de definición de servicio tiene normalmente la siguiente estructura:</p>
</div>
<div class="style-example">
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>  <span class="token comment">#script definición servicio </span>
  <span class="token comment"># $1 parámetro de ejecución del script</span>
  <span class="token keyword keyword-case">case</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token keyword keyword-in">in</span>
  start<span class="token punctuation">)</span>
  <span class="token comment">#Instrucciones para iniciar el servicio</span>
  <span class="token punctuation">;</span><span class="token punctuation">;</span>
  stop<span class="token punctuation">)</span>
  <span class="token comment">#Instrucciones para detener el servicio</span>
  <span class="token punctuation">;</span><span class="token punctuation">;</span>
  restart<span class="token punctuation">)</span>
  <span class="token comment">#Instrucciones para reiniciar el servicio</span>
  <span class="token punctuation">;</span><span class="token punctuation">;</span>
  status<span class="token punctuation">)</span>
  <span class="token comment">#Instrucciones parar comprobar el estado el servicio</span>
  <span class="token punctuation">;</span><span class="token punctuation">;</span>
  *<span class="token punctuation">)</span>
</code></pre>  <div style="page-break-after:always;"></div>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token comment">#Cualquier otra opción nuestra la ayuda de uso</span>
<span class="token builtin class-name">echo</span> <span class="token string">"Usage: <span class="token variable">$0</span> {start|stop|restart|status}"</span>
<span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword keyword-esac">esac</span>
<span class="token builtin class-name">exit</span> <span class="token number">0</span>
</code></pre></div>
<h4 id="operaciones">OPERACIONES </h4>
<div class="style-normal">
<p>Para ejecutar las operaciones básicas sobre un servicio se puede invocar el script del servicio con la opción deseada <code>/etc/init.d/&lt;servicio&gt; &lt;opcion&gt;</code> o bien ejecutar el comando <code>service &lt;servicio&gt; &lt;opcion&gt;</code></p>
</div>
<table>
<thead>
<tr>
<th>Acción</th>
<th>script</th>
<th>comando</th>
</tr>
</thead>
<tbody>
<tr>
<td>Mostrar</td>
<td><code>/etc/init.d/&lt;servicio&gt; status</code></td>
<td><code>service &lt;servicio&gt; status</code></td>
</tr>
<tr>
<td>Iniciar</td>
<td><code>/etc/init.d/&lt;servicio&gt; start</code></td>
<td><code>service &lt;servicio&gt; start</code></td>
</tr>
<tr>
<td>Detener</td>
<td><code>/etc/init.d/&lt;servicio&gt; stop</code></td>
<td><code>service &lt;servicio&gt; stop</code></td>
</tr>
<tr>
<td>Reiniciar</td>
<td><code>/etc/init.d/&lt;servicio&gt; restart</code></td>
<td><code>service &lt;servicio&gt; restart</code></td>
</tr>
</tbody>
</table>
<h4 id="runlevels">RUNLEVELS </h4>
<div class="style-normal">
<p>El runlevel (nivel de ejecución) determina el conjunto de servicios que <code>init</code> va a ejecutar por defecto. Por ejemplo, en un runlevel se puede iniciar el sistema con interfaz gráfica mientras que en otro no.</p>
<table>
<thead>
<tr>
<th>runlevel</th>
<th>descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>0</strong></td>
<td>Parada del sistema</td>
</tr>
<tr>
<td><strong>1</strong></td>
<td>Inicio Monousuario. Mantenimiento del sistema</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>Inicio Multiusuario sin soporte de red.</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>Inicio Multiusuario con soporte de red.</td>
</tr>
<tr>
<td><strong>4</strong></td>
<td>Inicio no definido. Para definir runlevel personalizado</td>
</tr>
<tr>
<td><strong>5</strong></td>
<td>Inicio Multiusario modo gráfico. Login en modo gráfico (X-Windows)</td>
</tr>
<tr>
<td><strong>6</strong></td>
<td>Reinicio del sistema</td>
</tr>
<tr>
<td><strong>S</strong></td>
<td>Arranque Base. Se ejecuta antes que cualquier otro runlevel solo durante el arranque del sistema. Configura lo mínimo necesario para que el sistema funcione: monta particiones, verifica sistemas de archivos, inicializa dispositivos, configura la consola,...</td>
</tr>
</tbody>
</table>
<p>Por cada runlevel existe un directorio <code>rcX.d</code> (X=runlevel) donde se define el conjunto de servicios que se ejecutan mediante <strong>enlaces simbólicos</strong> a los scripts del directorio <code>/etc/init.d</code>. La ubicación de los directorios <code>rcX.d</code> varía según la distribución de linux, normalmente: <code>/etc/rcX.d</code> o <code>/etc/rc.d/rcX.d</code>. Los <strong>nombres de los enlaces simbólicos</strong> siguen la siguiente estructura <code>[S|K]NNservicio</code></p>
<ul>
<li><strong>S</strong>   ejecuta el servicio con la opción start</li>
<li><strong>K</strong>   ejecuta el servicio con la opción stop</li>
<li><strong>NN</strong>  nº de orden de ejecución (01,02,03,...)</li>
<li><strong>servicio</strong> nombre del servicio en <code>/etc/init.d</code></li>
</ul>
<p>El proceso <code>init</code> utiliza el script <code>/etc/init.d/rc</code> para ejecutar los runlevels 0-6 y el script <code>/etc/init.d/rcS</code> para ejecutar S. Los servicios definidos se ejecutan secuencialmente en orden alfabetico. Por tanto, primero se ejecutan los que comienzan por K según su número de orden y luego los que comienzan por S según su número de orden.</p>
</div>
<div class="style-example">
<div class="admonition example">
<p class="admonition-title">Enlace simbolico</p>
<p>Ejemplo de enlaces simbólicos para rc3.d. Observar como los servicios ftp o squid no son referenciados por rc3.d.</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>/etc/init.d/
├── rc
├── apache2
├── <span class="token function">ssh</span>
├── network
├── <span class="token function">ftp</span>
├── squid

/etc/rc3.d/
├── S01network -<span class="token operator">&gt;</span> <span class="token punctuation">..</span>/init.d/network
├── S02ssh -<span class="token operator">&gt;</span> <span class="token punctuation">..</span>/init.d/ssh
├── K01apache2 -<span class="token operator">&gt;</span> <span class="token punctuation">..</span>/init.d/apache2
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">Conocer el runlevel actual</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>runlevel
N <span class="token number">5</span>
<span class="token comment"># N runlevel anterior no definido</span>
<span class="token comment"># 5 runlevel actual multiusuario grafico</span>
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">Ejecutar o cambiar un runlevel</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token comment"># Ejecutar runlevel de reinicio de maquina</span>
init <span class="token number">6</span>
</code></pre></div>
</div>
<div class="style-normal">
<p>Para <strong>generar los enlaces simbolicos</strong> asociados a un runlevel utilizaremos el comando <code>update-rc.d</code>.</p>
</div>
<div class="style-example">
<div class="admonition example">
<p class="admonition-title">update-rc.d</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token comment"># Iniciar y parar un servicio en runlevel por defecto </span>
<span class="token comment"># (start=2,3,4,5, stop=0,1,6) prioridad 30 start y 15 stop.</span>
update-rc.d <span class="token operator">&lt;</span>servicio<span class="token operator">&gt;</span> defaults <span class="token number">30</span> <span class="token number">15</span>
<span class="token comment"># Iniciar un servicio en runlevel 3 y 5 prioridad 30</span>
update-rc.d <span class="token operator">&lt;</span>servicio<span class="token operator">&gt;</span> start <span class="token number">30</span> <span class="token number">3</span> <span class="token number">5</span>
<span class="token comment"># Detener un servicio en runlevel 3 y 5 prioridad 15</span>
update-rc.d <span class="token operator">&lt;</span>servicio<span class="token operator">&gt;</span> stop <span class="token number">15</span> <span class="token number">3</span> <span class="token number">5</span>
</code></pre></div>
</div>
<div style="page-break-after:always;"></div>
<h4 id="inittab">INITTAB </h4>
<div class="style-normal">
<p>El fichero de configuración del proceso <code>init</code> es <code>/etc/inittab</code>. Le indica al proceso <code>init</code> que acciones realizar en el arranque del sistema como por ejemplo: el runlevel predeterminado, el script de arranque base, etc... El fichero está formado por lineas de entrada con el siguiente formato: <strong>id:runlevels:action:process</strong></p>
</div>
<div class="style-list">
<ul>
<li><strong>id</strong><br>
Identificador único para la entrada</li>
<li><strong>runlevels</strong><br>
Especifica los runlevels a los que se aplica la entrada. Cuando esta vacio, significa cualquier runlevel.</li>
<li><strong>action</strong><br>
Especifica que acción debe realizar init, entre otras tenemos:
<table>
<thead>
<tr>
<th>action</th>
<th>descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td>respawn</td>
<td>Reiniciar el proceso si está parado</td>
</tr>
<tr>
<td>wait</td>
<td>Esperar a que el proceso termine antes de continuar</td>
</tr>
<tr>
<td>once</td>
<td>Ejecutar el proceso solo una vez al entrar en runlevel</td>
</tr>
<tr>
<td>initdefault</td>
<td>Especifica el runlevel por defecto</td>
</tr>
<tr>
<td>sysinit</td>
<td>Ejecutar al inicio antes de cualquier runlevel</td>
</tr>
</tbody>
</table>
</li>
<li><strong>process</strong><br>
Comando o script a ejecutar</li>
</ul>
</div>
<div class="style-example">
<div class="admonition example">
<p class="admonition-title">inittab</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token comment"># /etc/inittab</span>
<span class="token comment"># runlevel por defecto 3</span>
id:3:initdefault:
<span class="token comment"># proceso de arranque rcS </span>
si::sysinit:/etc/init.d/rcS
<span class="token comment"># Niveles de ejecución</span>
<span class="token comment"># Nivel 0 ejecutar rc 0</span>
l0:0:wait:/etc/init.d/rc <span class="token number">0</span>
<span class="token comment"># Nivel 1 ejecutar rc 1</span>
l1:1:wait:/etc/init.d/rc <span class="token number">1</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token comment"># Se omiten lineas de la salida</span>
</code></pre></div>
</div>
<h4 id="ficheros-de-log">FICHEROS DE LOG </h4>
<div class="style-normal">
<p><code>System V</code> no utiliza un sistema centralizado de registro de logs (bitácora), depende de otros servicios del sistema para registar eventos, especialmente el sistema de logging tradicional de linux <code>syslog</code>. Esto quiere decir que los mensajes de los servicios de <code>/etc/init.d/</code> no se registran automáticamente a no ser que utilicen llamadas a <code>syslog</code>.</p>
<p>El sistema de logging <code>syslog</code> es gestionado tradicionalmente por el demonio <code>syslogd</code> o en distribuciones más modernas <code>rsyslogd</code>, <code>syslog-ng</code> o <code>busybox-syslog</code>.</p>
<p>Los registros de logging se escriben en archivos dentro del directorio <code>/var/log/</code>. Entre los archivos más comunes tenemos:</p>
<table>
<thead>
<tr>
<th>archivo log</th>
<th>descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/var/log/messages</code></td>
<td>Registro general del sistema</td>
</tr>
<tr>
<td><code>/var/log/syslog</code></td>
<td>Registro general en distribuciones Debian, Ubuntu,..</td>
</tr>
<tr>
<td><code>/var/log/auth.log</code></td>
<td>Registro de autenticaciones y sudo</td>
</tr>
<tr>
<td><code>/var/log/dmesg</code></td>
<td>Registro del kernel (hardware,arranque)</td>
</tr>
<tr>
<td><code>/var/log/boot.log</code></td>
<td>Registro del proceso de arranque</td>
</tr>
<tr>
<td><code>/var/log/daemon.log</code></td>
<td>Registro de servicios o demonios</td>
</tr>
<tr>
<td><code>/var/log/&lt;servicio&gt;</code></td>
<td>Registro particular de un servicio <br> Ej. <code>/var/log/ssh</code></td>
</tr>
</tbody>
</table>
<p>Para consultar los mensajes de log podemos usar los siguientes comandos: <code>less</code>, <code>tail</code>,<code>grep</code>...</p>
</div>
<div class="style-example">
<div class="admonition example">
<p class="admonition-title">consulta de syslog</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token comment">#less consultar el fichero syslog</span>
<span class="token comment">#para terminar pulsar q</span>
<span class="token function">less</span> /var/log/syslog

<span class="token comment">#tail consultar ultimos registros de syslog</span>
<span class="token function">tail</span> /var/log/syslog

<span class="token comment">#tail consultar ultimos 10 registros de syslog</span>
<span class="token function">tail</span> <span class="token parameter variable">--lines</span> <span class="token number">10</span> /var/log/syslog

<span class="token comment">#tail consultar ultimos registros de syslog y continuar a la escucha</span>
<span class="token comment">#para terminar pulsar CTRL+C</span>
<span class="token function">tail</span> <span class="token parameter variable">--follow</span> /var/log/syslog

<span class="token comment">#tail consultar todos los registros de syslog</span>
<span class="token function">tail</span> <span class="token parameter variable">--lines</span> +1 /var/log/syslog

<span class="token comment">#tail consultar ultimos registros de syslog solo para </span>
<span class="token comment">#el servicio dhclient</span>
<span class="token function">tail</span> /var/log/syslog <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"dhclient"</span>

<span class="token comment">#tail consultar los ultimos registros que hayan dado error</span>
<span class="token function">tail</span> /var/log/syslog <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"error"</span>

<span class="token comment">#tail consultar todos los registros de syslog para </span>
<span class="token comment">#el servicio dhclient en el mes de octubre que hayan dado error</span>
<span class="token function">tail</span> <span class="token parameter variable">--lines</span> +1 /var/log/syslog <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"dhclient"</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"Oct"</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"error"</span>
</code></pre><p>De la misma manera que hemos consultado /var/log/syslog podriamos haber realizado la consulta sobre cualquier otro fichero de log.</p>
</div>
</div>
<div style="page-break-after:always;"></div>
<h3 id="systemd">SYSTEMD </h3>
<div class="style-normal">
<p>El proceso inicial se llama <code>systemd</code> y ejecuta el comando <code>/sbin/systemd</code> con PID 1. La <strong>ejecución</strong> de los servicios se realiza <strong>en paralelo</strong>, es decir, cuando lanza la ejecución de un servicio no espera a su terminación antes de lanzar un nuevo servicio a no ser que existan dependencias entre ellos. El proceso <code>systemd</code> tiene asociado un fichero de configuración global que define su comportamiento <code>/etc/systemd/system.conf</code></p>
<p>Por otro lado, el gestor <code>systemd</code> está diseñado para ser compatible con los scripts de inicio de <code>init</code> (System V) y por tanto se pueden definir los servicios al estilo de <code>/etc/init.d</code>.</p>
</div>
<h4 id="servicios-1">SERVICIOS </h4>
<div class="style-normal">
<p>Para la definición de los servicios se utiliza el concepto de <strong>unidad</strong>. Una unidad es un objeto de <code>systemd</code> que realiza o controla una tarea o acción en particular, por ejemplo, gestionar procesos, organizar el arranque del sistema, crear sockets, montar sistemas de archivos, etc.. Para definir una unidad se utilizan los siguientes elementos:</p>
</div>
<div class="style-list">
<ul>
<li>
<p><strong>Archivo de configuración</strong><br>
Archivo que define la tarea que realiza la unidad.<br>
Se suelen utilizar los siguientes directorios:</p>
<table>
<thead>
<tr>
<th>Prioridad</th>
<th>Directorio</th>
<th>Proposito</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><code>/etc/systemd/system/</code></td>
<td>Unidades definidas por el usuario administrador del sistema. Se pueden modificar</td>
</tr>
<tr>
<td>2</td>
<td><code>/run/systemd/system</code></td>
<td>Unidades definidas temporalmente en tiempo de ejecución. Se pierden tras reiniciar</td>
</tr>
<tr>
<td>3</td>
<td><code>/lib/systemd/system/</code></td>
<td>Unidades definidas por la instalación de paquetes del sistema. No deben modificarse</td>
</tr>
</tbody>
</table>
<p>Si una unidad está definida en más de un directorio el orden de prioridad será: 1-&gt;2-&gt;3.</p>
</li>
<li>
<p><strong>Nombre</strong><br>
Identificador único de la unidad dentro del sistema.<br>
Es el nombre del archivo de configuración.</p>
</li>
<li>
<p><strong>Categoria</strong><br>
Se utiliza para agrupar unidades según su funcionalidad.<br>
Es la extensión del archivo de configuración. Algunas de ellas son:</p>
<table>
<thead>
<tr>
<th>Categoria</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td>.service</td>
<td>Servicio en el sistema</td>
</tr>
<tr>
<td>.target</td>
<td>Conjunto de unidades relacionadas entre sí. Similar a un runlevel</td>
</tr>
<tr>
<td>.automount</td>
<td>Punto de montaje automático para un sistema de archivos</td>
</tr>
<tr>
<td>.mount</td>
<td>Punto de montaje para un sistema de archivos</td>
</tr>
<tr>
<td>.device</td>
<td>Dispositivo físico reconocido por el kernel</td>
</tr>
<tr>
<td>.path</td>
<td>Monitoriza cambios en rutas de archivo para el control de los servicios</td>
</tr>
<tr>
<td>.scope</td>
<td>Organiza y gestiona procesos que se han creado externamente</td>
</tr>
<tr>
<td>.slice</td>
<td>Agrupación de recursos de sistema como la CPU o la memoria</td>
</tr>
<tr>
<td>.socket</td>
<td>Socket de comunicación entre procesos</td>
</tr>
<tr>
<td>.swap</td>
<td>Dispositivo o archivo de intercambio</td>
</tr>
<tr>
<td>.timer</td>
<td>Temporizador. Activa o desactiva un servicio específico basandose en temporizador</td>
</tr>
<tr>
<td>.snapshot</td>
<td>Realiza una instantánea del estado actual de todas las unidades en ejecución. Se utiliza para copia y restauración del sistema</td>
</tr>
<tr>
<td>.busname</td>
<td>Controla un sistema DBUS, o sistema de comunicación entre procesos</td>
</tr>
</tbody>
</table>
<p>Como podemos ver para definir un servicio se utilizaría la categoría <strong>.service</strong></p>
</li>
</ul>
</div>
<div class="style-example">
<div class="admonition example">
<p class="admonition-title">Archivo de configuración de unidad</p>
<p>El archivo <code>/etc/systemd/system/mi-servicio.service</code> sería un archivo de configuración de la unidad mi-servicio que pertenece a la categoria service y que ha sido definida por el administrador del sistema.</p>
</div>
</div>
<div class="style-normal">
<p><strong>Estructura archivo de configuración</strong></p>
<p>Los archivos de configuración de unidades definen los valores que tienen los parámetros de configuración de las unidades agrupados en diferentes secciones.</p>
</div>
<div class="style-example">
<div class="admonition example">
<p class="admonition-title">Estructura definición unidad</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token punctuation">[</span>sección<span class="token punctuation">]</span>
parámetro<span class="token operator">=</span>valor
parámetro<span class="token operator">=</span>valor
<span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token punctuation">[</span>sección<span class="token punctuation">]</span>
parámetro<span class="token operator">=</span>valor
<span class="token punctuation">..</span><span class="token punctuation">..</span> 
</code></pre></div>
</div>
<div class="style-normal">
<p>Las secciones pueden variar en función de la categoria de la unidad. Entre las <strong>secciones</strong> para la categoria <strong>.service</strong> tenemos:</p>
</div>
<div class="style-list">
<ul>
<li>
<p>[<code>Unit</code>]<br>
Describe unidad y su relación con otras unidades. Algunos parámetros de configuración son:</p>
<table>
<thead>
<tr>
<th>Parametro</th>
<th>Proposito</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Description</code></td>
<td>Descripción breve de la unidad</td>
</tr>
<tr>
<td><code>Documentation</code></td>
<td>Indica las URIs donde encontrar información sobre la unidad</td>
</tr>
<tr>
<td><code>Wants</code></td>
<td>Lista de unidades no críticas que se desean que esten activas para iniciar la unidad.</td>
</tr>
<tr>
<td><code>Requires</code></td>
<td>Lista de unidades críticas que se requiere que esten activas para iniciar la unidad.</td>
</tr>
<tr>
<td><code>BindsTo</code></td>
<td>Similar a <code>Requires</code></td>
</tr>
<tr>
<td><code>Before</code></td>
<td>Indica que la unidad debe iniciarse antes de las unidades listadas</td>
</tr>
<tr>
<td><code>After</code></td>
<td>Indica que la unidad deben iniciarse despues de las unidades listadas</td>
</tr>
<tr>
<td><code>Conflicts</code></td>
<td>Lista de unidades con la unidad no debe ejecutarse al mismo tiempo</td>
</tr>
<tr>
<td><code>Condition&lt;nombre&gt;</code></td>
<td>Condicion que debe cumplir la unidad para iniciarse</td>
</tr>
<tr>
<td><code>Assert&lt;nombre&gt;</code></td>
<td>Igual que Condition pero se lanza un error sino se cumple</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>[<code>Install</code>]<br>
Contiene los parámetros relacionados con las acciones que se deben realizar para habilitar o deshabilitar una unidad. Si la unidad no incluye esta sección se podra iniciar manualmente pero no se podrá habilitar para el inicio automático. Algunos parámetros de configuración son:</p>
<table>
<thead>
<tr>
<th>Parametro</th>
<th>Proposito</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>WantedBy</code></td>
<td>Lista de unidades (target) que quieren que esta unidad esté activa. Es la contraparte de <code>wants</code>, desde el punto de vista de la unidad dependiente. Se usa para crear enlaces simbólicos en <code>/etc/systemd/system/&lt;target&gt;.wants/</code></td>
</tr>
<tr>
<td><code>RequiredBy</code></td>
<td>Igual que <code>WantedBy</code> pero con dependencia. Se usa para crear enlaces simbólicos en <code>/etc/systemd/system/&lt;target&gt;.requires</code></td>
</tr>
<tr>
<td><code>Alias</code></td>
<td>Nombre alternativo para la unidad</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>[<code>Service</code>]<br>
Contiene los parámetros relacionados con las unidades de la categoria servicio. Algunos parámetros de configuración son:</p>
<table>
<thead>
<tr>
<th>Parametro</th>
<th>Proposito</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Type</code></td>
<td>Tipo de servicio: <br><code>simple</code>. El servicio ejecuta en primer plano un único proceso<br><code>forking</code>. El servicio ejecuta un proceso principal o padre que lanza un proceso hijo, normalmente en segundo plano (daemon), y termina.<br><code>oneshot</code>. El servicio ejecuta  un proceso que termina inmediatamente al ejecutar su tarea.<br><code>notify</code>. El servicio ejecuta un proceso que envía una notificación a systemd cuando ha terminado de inicializarse y de esa manera pasar a estado <code>active</code>.<br><code>dbus</code>. El servicio lanza un proceso que se considera iniciado cuando se registra un nombre en el bus de D-Bus.<br><code>exec</code>. Similar a simple pero más estricto.<br><code>idle</code>. Como <code>simple</code>pero systemd espera a que el resto del arranque del sistema termine antes de ejecutar el servicio.</td>
</tr>
<tr>
<td><code>ExecStart</code></td>
<td>Comando que se ejecuta para iniciar el servicio.</td>
</tr>
<tr>
<td><code>ExecStartPre</code></td>
<td>Comando(s) que se ejecutan antes de <code>ExecStart</code>. Si fallan, el servicio no arranca.</td>
</tr>
<tr>
<td><code>ExecStartPost</code></td>
<td>Comando(s) que se ejecutan después de <code>ExecStart</code>, una vez que el proceso principal arranca correctamente.</td>
</tr>
<tr>
<td><code>ExecReload</code></td>
<td>Comando que se ejecuta cuando se llama a <code>systemctl reload</code>.</td>
</tr>
<tr>
<td><code>ExecStop</code></td>
<td>Comando que se ejecuta para detener el servicio (si no se quiere usar SIGTERM).</td>
</tr>
<tr>
<td><code>ExecStopPost</code></td>
<td>Comando que se ejecuta después de detener el servicio.</td>
</tr>
<tr>
<td><code>Restart</code></td>
<td>Define si el servicio debe reiniciarse al fallar. Ej: <code>no</code>, <code>on-failure</code>, <code>always</code>, <code>on-abort</code>, etc.</td>
</tr>
<tr>
<td><code>RestartSec</code></td>
<td>Cuántos segundos esperar antes de reiniciar. Ej:<code>5</code></td>
</tr>
<tr>
<td><code>KillMode</code></td>
<td>Define como se terminan los procesos asociados a la unidad cuando ésta se detiene. Pare ello se envía señales <code>SIGTERM</code> y/o <code>SIGKILL</code> a los procesos. Tenemos los siguientes valores:  <br><code>control-group</code>. Termina el cgroup ,es decir, el proceso y todos los recursos y procesos hijos que dependen de el. <br> <code>process</code>. Termina solo el proceso principal. <br> <code>mixed</code>. Termina primero  el proceso principal y si no termina en un tiempo termina el cgroup.<br><code>none</code>. No envia ninguna señal de terminación a los procesos.</td>
</tr>
<tr>
<td><code>User</code></td>
<td>Usuario con el que se ejecuta el servicio.</td>
</tr>
<tr>
<td><code>Group</code></td>
<td>Grupo con el que se ejecuta.</td>
</tr>
<tr>
<td><code>WorkingDirectory</code></td>
<td>Directorio de trabajo antes de ejecutar el servicio.</td>
</tr>
<tr>
<td><code>Environment</code></td>
<td>Define variables de entorno. Ej: <code>Environment="PORT=3000"</code></td>
</tr>
<tr>
<td><code>EnvironmentFile</code></td>
<td>Archivo desde el cual cargar variables de configuración del servicio. Ej: <code>/etc/default/mi-app</code></td>
</tr>
<tr>
<td><code>TimeoutStartSec</code></td>
<td>Tiempo máximo para que el servicio arranque.</td>
</tr>
<tr>
<td><code>TimeoutStopSec</code></td>
<td>Tiempo máximo para que el servicio se detenga.</td>
</tr>
<tr>
<td><code>RemainAfterExit</code></td>
<td>Útil para servicios <code>oneshot</code>, si se establece en <code>yes</code>, el servicio se considera activo tras la ejecución.</td>
</tr>
<tr>
<td><code>GuessMainPID</code></td>
<td>Solo para <code>forking</code>. Indica si systemd debe intentar adivinar el PID principal.</td>
</tr>
<tr>
<td><code>CapabilityBoundingSet</code></td>
<td>Limita las capacidades Linux (capabilities) disponibles para el servicio.</td>
</tr>
<tr>
<td><code>ProtectSystem</code></td>
<td>Establece protección de solo lectura en partes del sistema de archivos.</td>
</tr>
<tr>
<td><code>NoNewPrivileges</code></td>
<td>Evita que el proceso y sus hijos ganen nuevos privilegios.</td>
</tr>
<tr>
<td><code>PrivateTmp</code></td>
<td>Si se pone <code>yes</code>, le da al servicio su propio <code>/tmp</code> aislado.</td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
<div style="page-break-after:always;"></div>
<div class="style-example">
<div class="admonition example">
<p class="admonition-title">Definición servicio ssh</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token comment">#archivo de unidad en /lib/systemd/system/ssh.service</span>

<span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>OpenBSD Secure Shell server
<span class="token assign-left variable">After</span><span class="token operator">=</span>network.target auditd.service
<span class="token assign-left variable">ConditionPathExists</span><span class="token operator">=</span><span class="token operator">!</span>/etc/ssh/sshd_not_to_be_run

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target
<span class="token assign-left variable">Alias</span><span class="token operator">=</span>sshd.service

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">EnvironmentFile</span><span class="token operator">=</span>/etc/default/ssh
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/sbin/sshd <span class="token parameter variable">-D</span> <span class="token variable">$SSHD_OPTS</span>
<span class="token assign-left variable">ExecReload</span><span class="token operator">=</span>/bin/kill <span class="token parameter variable">-HUP</span> <span class="token variable">$MAINPID</span>
<span class="token assign-left variable">KillMode</span><span class="token operator">=</span>process
<span class="token assign-left variable">Restart</span><span class="token operator">=</span>on-failure
<span class="token assign-left variable">RestartPreventExitStatus</span><span class="token operator">=</span><span class="token number">255</span>
<span class="token assign-left variable">Type</span><span class="token operator">=</span>notify

<span class="token comment"># La variable SSHD_OPTS se encuentra definida en /etc/ default/ssh. </span>
<span class="token comment"># La variable MAINPID se crea al cargarse la unidad</span>
</code></pre></div>
</div>
<h4 id="runlevels-1">RUNLEVELS </h4>
<div class="style-normal">
<p>Systemd emula los niveles de ejecución de System V a través de unidades de tipo target. Las equivalencias son las siguientes:</p>
</div>
<table>
<thead>
<tr>
<th>RunLevel</th>
<th>Descripción</th>
<th>Unidad</th>
<th>Alias</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Apagar sistema</td>
<td>poweroff.target</td>
<td>runlevel0.target</td>
</tr>
<tr>
<td>1</td>
<td>Inicio monousuario</td>
<td>rescue.target</td>
<td>runlevel1.target</td>
</tr>
<tr>
<td>2</td>
<td>Inicio multiusuario sin red</td>
<td>multi-user.target</td>
<td>runlevel2.target</td>
</tr>
<tr>
<td>3</td>
<td>Inicio multiusuario con red</td>
<td>multi-user.target</td>
<td>runlevel3.target</td>
</tr>
<tr>
<td>4</td>
<td>Inicio personalizado</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>5</td>
<td>Inicio multiusuario gráfico</td>
<td>graphical.target</td>
<td>runlevel5.target</td>
</tr>
<tr>
<td>6</td>
<td>Reinicio</td>
<td>reboot.target</td>
<td>runlevel6.target</td>
</tr>
<tr>
<td>-</td>
<td>Emergencia</td>
<td>emergency.target</td>
<td>-</td>
</tr>
</tbody>
</table>
<div style="page-break-after:always;"></div>
<div class="style-normal">
<p>La manera más habitual de asociar un servicio a un determinado runlevel es añadir una propiedad WantedBy en la sección install del servicio.</p>
</div>
<div class="style-example">
<div class="admonition example">
<p class="admonition-title">servicio ssh asociado a runlevel multi-user</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token comment">#archivo de unidad en /lib/systemd/system/ssh.service</span>

<span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>OpenBSD Secure Shell server
<span class="token assign-left variable">After</span><span class="token operator">=</span>network.target auditd.service
<span class="token assign-left variable">ConditionPathExists</span><span class="token operator">=</span><span class="token operator">!</span>/etc/ssh/sshd_not_to_be_run

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target
<span class="token assign-left variable">Alias</span><span class="token operator">=</span>sshd.service
<span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token comment"># Al asignar la propiedad WantedBy a multi-user.target se crea un enlace simbólico </span>
<span class="token comment"># al servicio en el  directorio /etc/system/systemd/multi-user.target.wants </span>
<span class="token comment"># De forma similar sucedería si en lugar de WantedBy se utiliza RequieredBy.</span>
</code></pre></div>
</div>
<h4 id="operaciones-1">OPERACIONES </h4>
<div class="style-normal">
<p>Para realizar operaciones sobre las unidades y servicios en <code>systemd</code> utilizaremos el comando <code>systemctl</code>. Este comando tiene numerosas opciones que puedes consultar en <a href="https://man7.org/linux/man-pages/man1/systemctl.1.html">man systemctl</a>. Entre ellas tenemos:</p>
</div>
<table>
<thead>
<tr>
<th>Operación</th>
<th>Comando</th>
</tr>
</thead>
<tbody>
<tr>
<td>Iniciar</td>
<td><code>systemctl start &lt;servicio&gt;</code></td>
</tr>
<tr>
<td>Parar</td>
<td><code>systemctl stop &lt;servicio&gt;</code></td>
</tr>
<tr>
<td>Reiniciar</td>
<td><code>systemctl restart &lt;servicio&gt;</code></td>
</tr>
<tr>
<td>Mostrar estado</td>
<td><code>systemctl status &lt;servicio&gt;</code></td>
</tr>
<tr>
<td>Recargar configuración</td>
<td><code>systemctl reload &lt;servicio&gt;</code></td>
</tr>
<tr>
<td>Habilitar</td>
<td><code>systemctl enable &lt;servicio&gt;</code></td>
</tr>
<tr>
<td>Deshabilitar</td>
<td><code>systemctl disable &lt;servicio&gt;</code></td>
</tr>
<tr>
<td>Enmascarar</td>
<td><code>systemctl mask &lt;servicio&gt;</code></td>
</tr>
<tr>
<td>Desenmascarar</td>
<td><code>systemctl umask &lt;servicio&gt;</code></td>
</tr>
<tr>
<td>Activo?</td>
<td><code>systemctl is-active &lt;servicio&gt;</code></td>
</tr>
<tr>
<td>Habilitado?</td>
<td><code>systemctl is-enabled &lt;servicio&gt;</code></td>
</tr>
<tr>
<td>Fallo?</td>
<td><code>systemctl is-failed &lt;servicio&gt;</code></td>
</tr>
<tr>
<td>Dependecias after</td>
<td><code>systemctl list-dependecies --after &lt;servicio&gt;</code></td>
</tr>
<tr>
<td>Dependecias before</td>
<td><code>systemctl list-dependecies --before &lt;servicio&gt;</code></td>
</tr>
<tr>
<td>Mostrar fichero configuración</td>
<td><code>systemctl cat &lt;servicio&gt;.service</code></td>
</tr>
<tr>
<td>Mostrar propiedades configuración</td>
<td><code>systemctl show &lt;servicio&gt;.service</code></td>
</tr>
<tr>
<td>Editar fichero configuración</td>
<td><code>systemctl edit --full --force &lt;servicio&gt;.service</code></td>
</tr>
<tr>
<td>Mostrar runlevel por defecto</td>
<td><code>systemctl get-default</code></td>
</tr>
<tr>
<td>Cambiar runlevel por defecto</td>
<td><code>systemctl set-default &lt;runlevel.target&gt;</code></td>
</tr>
<tr>
<td>Cambiar runlevel</td>
<td><code>systemctl isolate &lt;runlevel.target&gt;</code></td>
</tr>
<tr>
<td>Mostrar unidades sistema</td>
<td><code>systemctl list-units</code> <br> <code>systemctl list-units-files</code></td>
</tr>
<tr>
<td>Mostrar servicios sistema</td>
<td><code>systemctl list-units --type=service [--state={active|inactive|failed|dead|running}]</code></td>
</tr>
<tr>
<td>Aplicar cambios sin reiniciar</td>
<td><code>systemctl daemon-reload</code></td>
</tr>
</tbody>
</table>

<div class="style-normal">
<p>También podemos utilizar para iniciar, parar, pausar o mostrar el estado de un servicio en lugar de <code>systemctl</code> el comando <code>service</code>.</p>
</div>
<div class="style-example">
<div class="admonition example">
<p class="admonition-title">Mostrar estado de un servicio</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>systemctl status <span class="token function">ssh</span>

ssh.service - OpenBSD Secure Shell server
Loaded: loaded <span class="token punctuation">(</span>/lib/systemd/system/ssh.service<span class="token punctuation">;</span> enabled<span class="token punctuation">;</span> vendor preset: enabled<span class="token punctuation">)</span>
Active: active <span class="token punctuation">(</span>running<span class="token punctuation">)</span> since Thu <span class="token number">2025</span>-10-09 <span class="token number">14</span>:18:06 CEST<span class="token punctuation">;</span> 6h ago
  Docs: man:sshd<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
        man:sshd_config<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
Process: <span class="token number">384</span> <span class="token assign-left variable">ExecStartPre</span><span class="token operator">=</span>/usr/sbin/sshd <span class="token parameter variable">-t</span>
<span class="token punctuation">(</span>code<span class="token operator">=</span>exited, <span class="token assign-left variable">status</span><span class="token operator">=</span><span class="token number">0</span>/SUCCESS<span class="token punctuation">)</span>
 Main PID: <span class="token number">395</span> <span class="token punctuation">(</span>sshd<span class="token punctuation">)</span>
 Tasks: <span class="token number">1</span> <span class="token punctuation">(</span>limit: <span class="token number">528</span><span class="token punctuation">)</span>
 Memory: <span class="token number">3</span>.7M
 CPU: 34ms
 CGroup: /system.slice/ssh.service
         └─395 sshd: /usr/sbin/sshd <span class="token parameter variable">-D</span> <span class="token punctuation">[</span>listener<span class="token punctuation">]</span> <span class="token number">0</span> of
          <span class="token number">10</span>-100 startups
</code></pre><p>La propiedad <code>Main PID</code> nos indica el identificador del proceso asociado al servicio. La propiedad <code>cgroup</code> nos muestra los recursos y procesos asociados al servicio.</p>
<p>La propiedad <code>loaded</code> nos muestra el estado del servicio en cuanto al momento en el que se inicia ("carga") en el sistema:</p>
<table>
<thead>
<tr>
<th>valor</th>
<th>descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>enable</code></td>
<td>Servicio que se ejecuta en el arranque del sistema automáticamente.</td>
</tr>
<tr>
<td><code>static</code></td>
<td>Servicio que se ejecuta manualmente o por otra unidad.</td>
</tr>
<tr>
<td><code>disabled</code></td>
<td>Servicio que no se ejecuta en el arranque del sistema de manera automática. Se puede ejecutar manualmente.</td>
</tr>
<tr>
<td><code>masked</code></td>
<td>Servicio que esta deshabilitada y que no se puede ejecutar ni siquiera manualmente. Es como bloquear el servicio.</td>
</tr>
</tbody>
</table>
<p>La propiedad <code>active</code> nos muestra el estado del servicio en cuanto a su ejecución:</p>
<table>
<thead>
<tr>
<th>valor</th>
<th>descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>active</code></td>
<td>El servicio esta en ejecución.</td>
</tr>
<tr>
<td><code>inactive</code></td>
<td>El servicio no esta en ejecución.1</td>
</tr>
<tr>
<td><code>failed</code></td>
<td>El servicio ha fallado.</td>
</tr>
<tr>
<td><code>activating</code></td>
<td>El servicio se está iniciando.</td>
</tr>
<tr>
<td><code>deactivating</code></td>
<td>El servicio se está parando.</td>
</tr>
</tbody>
</table>
</div>
<div class="admonition example">
<p class="admonition-title">Runlevel</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token comment">#Obtener el runlevel por defecto</span>
systemctl get-default

<span class="token comment">#Cambiar el runlevel por defecto a multi-user</span>
systemctl set-default multi-user.target

<span class="token comment">#Cambiar el runlevel actual para apagar la maquina</span>
systemctl isolate poweroff.target
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">Mostrar servicios</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token comment">#En la salida de los comandos se muestran solo algunas</span>
<span class="token comment">#líneas a modo de ejemplo.</span>

<span class="token comment">#Mostrar servicio inactivos</span>
systemctl list-units <span class="token parameter variable">--type</span><span class="token operator">=</span>service <span class="token parameter variable">--state</span><span class="token operator">=</span>inactive

UNIT                            LOAD   ACTIVE    SUB DESCRIPTION
apt-daily-upgrade.service       loaded inactive  dead  Daily <span class="token function">apt</span> updgrade and clean
apt-daily.service               loaded inactive dead Daily <span class="token function">apt</span> download activities
<span class="token punctuation">..</span><span class="token punctuation">..</span>.
</code></pre><pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token comment">#Mostrar servicios activos</span>
systemctl list-units <span class="token parameter variable">--type</span><span class="token operator">=</span>service <span class="token parameter variable">--state</span><span class="token operator">=</span>active

UNIT                            LOAD   ACTIVE    SUB DESCRIPTION
apparmor.service                loaded active    exited Load AppArmor profiles
cron.service                    loaded active    running Background processing daemon
networking.service              loaded active    exited Raise network interfaces
ssh.service                     loades active     running OpenBSD Secure Shell Server
<span class="token punctuation">..</span><span class="token punctuation">..</span>.
</code></pre><pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token comment">#Mostrar servicios en ejecución</span>
systemctl list-units <span class="token parameter variable">--type</span><span class="token operator">=</span>service <span class="token parameter variable">--state</span><span class="token operator">=</span>running

UNIT                            LOAD   ACTIVE    SUB DESCRIPTION
cron.service                    loaded active    running Background processing daemon
ssh.service                     loades active     running OpenBSD Secure Shell Server
<span class="token punctuation">..</span><span class="token punctuation">..</span>.
</code></pre></div>
</div>
<h4 id="ficheros-de-log-1">FICHEROS DE LOG </h4>
<div class="style-normal">
<p><code>Systemd</code> utiliza un sistema centralizado de registro de logs (bitácora) denominado <code>journal</code>que gestiona y almacena eventos del sistema, servicios, kernel y usuarios. El sistema <code>journal</code>es gestionado por el servicio <code>systemd-journald</code>.</p>
<p>Los registros generados por <code>journal</code> pueden ser consultados con la herramienta <code>journalctl</code>. Puedes obtener información de este comando en <a href="https://man7.org/linux/man-pages/man1/journalctl.1.html">man journalctl</a>. Entre las opciones más comunes:</p>
</div>
<table>
<thead>
<tr>
<th>opción</th>
<th>descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--unit &lt;servicio&gt;</code></td>
<td>Registros para un determinado servicio</td>
</tr>
<tr>
<td><code>--lines &lt;n&gt;</code></td>
<td>Muestra n registros más recientes. También admite all.</td>
</tr>
<tr>
<td><code>--follow</code></td>
<td>Muestra los registros más recientes y continua a la escucha. Se termina la escucha con CTRL+C</td>
</tr>
<tr>
<td><code>--since "&lt;fecha&gt;"</code></td>
<td>Muestra los registros desde la fecha. La fecha en formato americano yyyy-mm-dd hh:mm:ss. También admite today,yesterday,now,ago,...</td>
</tr>
<tr>
<td><code>--until "&lt;fecha&gt;"</code></td>
<td>Muestra los registros hasta la fecha. La fecha en formato americano yyyy-mm-dd hh:mm:ss. También admite today,yesterday,now,ago...</td>
</tr>
<tr>
<td><code>--priority &lt;n&gt;</code></td>
<td>Muestra los registros según su prioridad. <br>0 emerg<br>1 alert<br>2 crit<br>3 err<br>4 warning<br>5 notice<br>6 info<br>7 debug</td>
</tr>
</tbody>
</table>
<div class="style-example">
<div class="admonition example">
<p class="admonition-title">journalctl</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token comment">#Todos los registros de ssh</span>
journalctl <span class="token parameter variable">--unit</span> <span class="token function">ssh</span>

<span class="token comment">#Los ultimos 20 registros de ssh</span>
journalctl <span class="token parameter variable">--lines</span> <span class="token number">20</span> <span class="token parameter variable">--unit</span> <span class="token function">ssh</span>

<span class="token comment">#Los ultimos registros de ssh y mantenerse</span>
journalctl <span class="token parameter variable">--follow</span> <span class="token parameter variable">--unit</span> <span class="token function">ssh</span>

<span class="token comment">#Los registros de ssh desde hace 1 minuto</span>
journalctl <span class="token parameter variable">--since</span> <span class="token string">"1 minute ago"</span> <span class="token parameter variable">--unit</span> <span class="token function">ssh</span>
</code></pre><pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code><span class="token comment">#Los registros de ssh desde hace 2 dias</span>
journalctl <span class="token parameter variable">--since</span> <span class="token string">"2 days ago"</span> <span class="token parameter variable">--unit</span> <span class="token function">ssh</span>

<span class="token comment">#Todos los registros de ssh de tipo error</span>
journalctl <span class="token parameter variable">--lines</span> all <span class="token parameter variable">--priority</span> <span class="token number">3</span> <span class="token parameter variable">--unit</span> <span class="token function">ssh</span>

<span class="token comment">#Los ultimos 10 registros de ssh de tipo error</span>
journalctl <span class="token parameter variable">--lines</span> <span class="token number">10</span> <span class="token parameter variable">--priority</span> <span class="token number">3</span> <span class="token parameter variable">--unit</span> <span class="token function">ssh</span>

<span class="token comment">#Todos los registros de error de hoy</span>
journalctl <span class="token parameter variable">--lines</span> all <span class="token parameter variable">--priority</span> <span class="token number">3</span> <span class="token parameter variable">--since</span> <span class="token string">"today"</span>

</code></pre></div>
</div>

      </div>
      
      
    
    
    
    
    
    
  
    </body></html>